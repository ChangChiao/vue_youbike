var ve=Object.defineProperty,be=Object.defineProperties;var Se=Object.getOwnPropertyDescriptors;var pe=Object.getOwnPropertySymbols;var xe=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable;var ue=(t,o,a)=>o in t?ve(t,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[o]=a,A=(t,o)=>{for(var a in o||(o={}))xe.call(o,a)&&ue(t,a,o[a]);if(pe)for(var a of pe(o))ke.call(o,a)&&ue(t,a,o[a]);return t},W=(t,o)=>be(t,Se(o));import{u as ye,r as b,o as g,c as w,a as i,F as D,b as X,d as S,w as Le,e as E,f as H,t as I,g as se,T as $e,p as ne,h as re,i as Z,j as T,k as q,l as V,m as ie,n as Pe,q as Ae,s as Ie,v as U,x as he,L as f,y as Ce,z as Me,A as ee,B as te,C as oe,D as ge,E as Te,G as Ue,H as Be,V as Re,I as Ne,J,K as Ke,M as De,N as je,O as Oe,P as Ve,Q as ze,R as Ee,S as He}from"./vendor.4f037639.js";const Ye=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&e(c)}).observe(document,{childList:!0,subtree:!0});function a(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function e(s){if(s.ep)return;s.ep=!0;const r=a(s);fetch(s.href,r)}};Ye();var me="./images/logo.png";var C=(t,o)=>{for(const[a,e]of o)t[a]=e;return t};const Ge={setup(){const t=ye();return{menuList:[{title:"\u5C0B\u627E\u55AE\u8ECA",path:"/bike"},{title:"\u5C0B\u627E\u8ECA\u9053",path:"/route"}],goHome:()=>{t.push("/")}}}},Ze={class:"flex relative z-50 justify-between shadow-lg items-center px-3 font-medium h-20"},Fe={class:"menu flex"};function qe(t,o,a,e,s,r){const c=b("router-link");return g(),w("header",Ze,[i("img",{class:"w-20 cursor-pointer",src:me,alt:"",onClick:o[0]||(o[0]=(...n)=>e.goHome&&e.goHome(...n))}),i("ul",Fe,[(g(!0),w(D,null,X(e.menuList,n=>(g(),w("li",{class:"mx-3 :mdtext-lg text-md text-primary-500",key:n.path},[S(c,{to:n.path,class:"duration-200"},{default:Le(()=>[H(I(n.title),1)]),_:2},1032,["to"])]))),128))]),E(` <font-awesome-icon
            class="for-mobile text-lg text-gray-500"
            icon="search"
        /> `)])}var Je=C(Ge,[["render",qe],["__scopeId","data-v-61dd7a3d"]]);const Qe={props:{showLoading:{type:Boolean,default:null}},setup(){}},We=t=>(ne("data-v-efe9d588"),t=t(),re(),t),Xe={key:0,class:"loading-wrap"},et=We(()=>i("svg",{class:"spinner",width:"65px",height:"65px",viewBox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg"},[i("circle",{class:"path",fill:"none","stroke-width":"6","stroke-linecap":"round",cx:"33",cy:"33",r:"30"})],-1)),tt=[et];function ot(t,o,a,e,s,r){return g(),se($e,{to:"#teleport-target"},[a.showLoading?(g(),w("div",Xe,tt)):E("v-if",!0)])}var at=C(Qe,[["render",ot],["__scopeId","data-v-efe9d588"]]);const st={components:{Loading:at,Header:Je},setup(){const t=Z(!1),o=Z(0);return T("setShowLoading",e=>{t.value=e}),T("isMobile",o),q(()=>{o.value=window.innerWidth<768}),{showLoading:t}}};function nt(t,o,a,e,s,r){const c=b("Header"),n=b("router-view"),y=b("loading");return g(),w(D,null,[S(c),S(n),S(y,{showLoading:e.showLoading},null,8,["showLoading"])],64)}var rt=C(st,[["render",nt]]);const Y="https://ptx.transportdata.tw/MOTC/v2",it=Y+"/Bike/Station",ct=Y+"/Bike/Availability",lt=Y+"/Cycling/Shape",dt=Y+"/Bike/Station/NearBy",pt=Y+"/Bike/Availability/NearBy",ut=Y+"/Tourism/ScenicSpot",yt=Y+"/Tourism/Restaurant",ce=[{label:"\u81FA\u5317\u5E02",value:"Taipei"},{label:"\u65B0\u5317\u5E02",value:"NewTaipei"},{label:"\u6843\u5712\u5E02",value:"Taoyuan"},{label:"\u81FA\u4E2D\u5E02",value:"Taichung"},{label:"\u81FA\u5357\u5E02",value:"Tainan"},{label:"\u9AD8\u96C4\u5E02",value:"Kaohsiung"},{label:"\u82D7\u6817\u7E23",value:"MiaoliCounty"},{label:"\u5609\u7FA9\u5E02",value:"Chiayi"},{label:"\u5C4F\u6771\u7E23",value:"PingtungCounty"},{label:"\u91D1\u9580\u7E23",value:"KinmenCounty"}],ht={props:{city:{type:String,default:""},keyword:{type:String,default:""}},emits:["updateCity","updateKeyword","search"],setup(t,{emit:o}){return{CITY_LIST:ce,updateKeyword:r=>{o("updateKeyword",r.target.value)},updateCity:r=>{o("updateCity",r.target.value)},search:()=>{o("search")}}}},gt={class:"input-box py-2"},mt=["value"],_t={class:"flex pt-3"},wt=["value"],ft=i("option",{value:""},"\u7E23\u5E02",-1),vt=["value"];function bt(t,o,a,e,s,r){const c=b("font-awesome-icon");return g(),w(D,null,[i("div",gt,[S(c,{class:"text-gray-500",icon:"search"}),i("input",{class:"w-1/2 pl-4",placeholder:"\u8F38\u5165\u95DC\u9375\u5B57",value:a.keyword,onInput:o[0]||(o[0]=(...n)=>e.updateKeyword&&e.updateKeyword(...n)),type:"text"},null,40,mt)]),i("div",_t,[i("select",{class:"w-1/2",value:a.city,onChange:o[1]||(o[1]=(...n)=>e.updateCity&&e.updateCity(...n))},[ft,(g(!0),w(D,null,X(e.CITY_LIST,n=>(g(),w("option",{key:n.value,value:n.value},I(n.label),9,vt))),128))],40,wt),i("button",{onClick:o[2]||(o[2]=(...n)=>e.search&&e.search(...n)),class:"ml-2 w-1/2 cursor-pointer"},"\u641C\u5C0B")])],64)}var le=C(ht,[["render",bt]]),St="./images/illustration.png";const xt={components:{Search:le},setup(){const t=ye(),o=V({city:"",keyword:""}),a=r=>{o.city=r},e=r=>{o.keyword=r},s=()=>{t.push({path:"/bike",query:{keyword:o.keyword,city:o.city}})};return W(A({},ie(o)),{search:s,updateCity:a,updateKeyword:e})}},ae=t=>(ne("data-v-c221866a"),t=t(),re(),t),kt={class:"cover relative bg-primary-100"},Lt={class:"search w-4/5 m-auto md:ml-40 pt-12 md:w-96 relative z-10"},$t=ae(()=>i("img",{class:"w-60",src:me,alt:""},null,-1)),Pt=ae(()=>i("p",{class:"text-2xl text-primary-500 font-extrabold"},"\u5C0B\u627E\u55AE\u8ECA,",-1)),At=ae(()=>i("p",{class:"text-2xl text-primary-500 font-extrabold pb-4"}," \u4F86\u5834\u60A0\u9592\u7684\u653E\u9B06\u4E4B\u65C5\uFF01 ",-1)),It=ae(()=>i("img",{class:"fixed bottom-10 md:w-2/3 left-0 right-0 mx-auto md:bottom-40",src:St},null,-1));function Ct(t,o,a,e,s,r){const c=b("Search");return g(),w("div",kt,[i("div",Lt,[$t,Pt,At,S(c,{onUpdateCity:e.updateCity,onUpdateKeyword:e.updateKeyword,onSearch:e.search,city:t.city,keyword:t.keyword},null,8,["onUpdateCity","onUpdateKeyword","onSearch","city","keyword"])]),It])}var Mt=C(xt,[["render",Ct],["__scopeId","data-v-c221866a"]]);const Tt=(t,o="success")=>{t&&console.log(t,o)},de=t=>{let o=new Date(t);return Pe(o).format("YYYY-MM-DD HH:mm:ss")},F=(t,o)=>{let a="",e="";switch(t){case 0:a="no-available",e="\u505C\u6B62\u71DF\u904B";break;case 1:a="available",e="\u6B63\u5E38\u71DF\u904B";break;case 2:a="no-rent",e="\u66AB\u505C\u71DF\u904B";break}return o==="color"?a:e},j=Ae.create({});j.interceptors.request.use(t=>{let o=t.params;return Object.keys(o).map(a=>{o[a]||delete o[a]}),t},t=>t);j.interceptors.response.use(t=>t.data,t=>{const{status:o}=t.response;return Tt(`error--${o}`,"error"),Promise.reject(t)});const G=()=>{let t="b65665fcca144956a79d25bb3edc7b34",o="daVxLDO01nPgTTwhQKVBmY-pjeQ";const a=new Date().toGMTString(),e=new Ie("SHA-1","TEXT");e.setHMACKey(o,"TEXT"),e.update("x-date: "+a);let s=e.getHMAC("B64");return{Authorization:`hmac username="${t}", algorithm="hmac-sha1", headers="x-date", signature="${s}"`,"X-Date":a,"Content-Type":"application/x-www-form-urlencoded"}},Q=t=>{const{city:o}=t;return delete t.city,{cityPath:o,data:t}},Ut=t=>{const{cityPath:o,data:a}=Q(t);let e={headers:G(),params:A({},a)};return j.get(it+`/${o}`,e)},Bt=t=>{const{cityPath:o,data:a}=Q(t);let e={headers:G(),params:A({},a)};return j.get(ct+`/${o}`,e)},Rt=t=>{const{cityPath:o,data:a}=Q(t);let e={headers:G(),params:A({},a)};return j.get(lt+`/${o}`,e)},Nt=t=>{let o={headers:G(),params:A({},t)};return j.get(dt,o)},Kt=t=>{let o={headers:G(),params:A({},t)};return j.get(pt,o)},Dt=t=>{const{cityPath:o,data:a}=Q(t);let e={headers:G(),params:A({},a)};return j.get(yt+`/${o}`,e)},jt=t=>{const{cityPath:o,data:a}=Q(t);let e={headers:G(),params:A({},a)};return j.get(ut+`/${o}`,e)},Ot={emit:[],setup(){const t=U("showStatus"),o=U("setShowStatus");return{showStatus:t,controlStatus:()=>{o(!1)}}}},Vt={class:"fixed for-mobile-flex flex-wrap flex justify-center items-center w-screen h-12 shadow-lg bottom-0 bg-white z-10"};function zt(t,o,a,e,s,r){return g(),w("div",Vt,[i("button",{class:"h-8 w-1/2 text-primary-500 text-sm available",onClick:o[0]||(o[0]=c=>e.controlStatus())}," \u986F\u793A\u5217\u8868 ")])}var _e=C(Ot,[["render",zt]]);const Et={components:{ViewBar:_e},props:{city:{type:String,default:""}},emits:["getRoute"],setup(t,{emit:o}){const a=U("isMobile");let e=null,s=null,r=null,c=null,n=null;const y=()=>{let u="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";e=f.map("map_route"),f.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:u}).addTo(e),n=new f.MarkerClusterGroup().addTo(e),l()},p=()=>{n.clearLayers(),e.eachLayer(u=>{u instanceof f.Marker&&e.removeLayer(u)})},K=u=>{let _=u.replace("MULTILINESTRING ((","").replace("))","").split(",");const x=_[0]&&_[0].split(" "),P=_[_.length-1]&&_[_.length-1].split(" ");n.addLayer(f.marker([x[1],x[0]],{icon:s})),n.addLayer(f.marker([P[1],P[0]],{icon:s})),e.addLayer(n),B(x[1],x[0]),R(x[1],x[0])},M=(u,L)=>{u.forEach(v=>{const{PositionLon:_,PositionLat:x}=v.Position;let P=L==="food"?r:c;n.addLayer(f.marker([x,_],{icon:P}).bindPopup(`<h1>${v.Name}</h1>
                        <p>${v.OpenTime}</p>
                        `))}),e.addLayer(n)},B=async(u,L)=>{const v={city:t.city,$spatialFilter:`nearby(${u},${L},${500})`};try{const _=await jt(v);M(_,"spot")}catch(_){console.log("error",_)}},R=async(u,L)=>{try{const v={city:t.city,$spatialFilter:`nearby(${u},${L},${500})`},_=await Dt(v);M(_,"food")}catch(v){console.log("error",v)}},l=()=>{o("getRoute")},m=()=>{s=new f.Icon({iconUrl:"/images/mark/no_rent.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),r=new f.Icon({iconUrl:"/images/mark/food.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),c=new f.Icon({iconUrl:"/images/mark/spot.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]})},N=u=>{console.log("Geometry",u),p();const L=new Ce.exports.Wkt;L.read(u);const v=L.toJson(),_={color:"#C50047",weight:5};n=f.geoJSON(v,{style:_}).addTo(e),n.addData(v),e.fitBounds(n.getBounds()),e.addLayer(n),K(u)};return q(()=>{m(),y()}),he(()=>{e=null,n=null}),{drawLine:N,isMobile:a}}},Ht=t=>(ne("data-v-3aad47fd"),t=t(),re(),t),Yt=Ht(()=>i("div",{id:"map_route",class:"map fixed z-10"},null,-1));function Gt(t,o,a,e,s,r){const c=b("ViewBar");return g(),w(D,null,[Yt,e.isMobile?(g(),se(c,{key:0})):E("v-if",!0)],64)}var Zt=C(Et,[["render",Gt],["__scopeId","data-v-3aad47fd"]]);const Ft={components:{VPagination:Me},setup(){const t=U("page"),o=U("totalPage"),a=U("setPage");return{page:t,totalPage:o,updateHandler:s=>{a(s)}}}},qt={class:"pt-4 flex justify-center"};function Jt(t,o,a,e,s,r){const c=b("v-pagination");return g(),w("div",qt,[S(c,{"v-model":e.page,pages:e.totalPage,"range-size":1,"active-color":"#DCEDFF","onUpdate:modelValue":e.updateHandler},null,8,["v-model","pages","onUpdate:modelValue"])])}var we=C(Ft,[["render",Jt]]);const Qt={components:{Pagination:we,Search:le},props:{singlePageList:{type:Array,default:()=>[]},keyword:{type:String,default:""},city:{type:String,default:""}},emits:["drawLine","updateKeyword","updateCity","search"],setup(t,{emit:o}){const a=U("setShowStatus"),e=()=>{a(!0)};return{drawLine:y=>{o("drawLine",y),e()},updateCity:y=>{o("updateCity",y)},updateKeyword:y=>{o("updateKeyword",y)},search:()=>{o("search")}}}},Wt={class:"h-full md:w-96 w-full fixed px-8 left-0 top-0 z-20 box-border pt-24 overflow-hidden bg-white"},Xt={class:"rounded-xl shadow-lg overflow-hidden"},eo=i("div",{class:"md:h-8 hidden md:block bg-primary-500"},null,-1),to={class:"p-4"},oo=i("h1",{class:"md:text-3xl hidden md:block font-bold mb-6"}," \u5C0B\u627E\u8ECA\u9053 ",-1),ao={class:"list overflow-y-scroll mt-8 md:mb-4"},so={class:""},no=["onClick"],ro={class:"text-xl font-bold pb-2"},io={class:"mr-8"},co=i("span",{class:"sub-title"},"\u958B\u59CB",-1),lo=i("span",{class:"sub-title"},"\u7D50\u675F",-1);function po(t,o,a,e,s,r){const c=b("Search"),n=b("font-awesome-icon"),y=b("pagination");return g(),w("div",Wt,[i("div",Xt,[eo,i("div",to,[oo,S(c,{onSearch:e.search,onUpdateCity:e.updateCity,onUpdateKeyword:e.updateKeyword,city:a.city,keyword:a.keyword},null,8,["onSearch","onUpdateCity","onUpdateKeyword","city","keyword"])])]),i("div",ao,[i("ul",so,[(g(!0),w(D,null,X(a.singlePageList,p=>(g(),w("li",{class:"bg-grey-100 rounded-xl mb-3 px-2 py-4 cursor-pointer",key:p.StationUID,onClick:K=>e.drawLine(p.Geometry)},[i("h3",ro,I(p.RouteName),1),i("h4",null,[S(n,{class:"text-primary-500",icon:"map-marker-alt"}),H(" "+I(p.City)+" "+I(p.Town||""),1)]),i("p",null,[i("span",io,[S(n,{class:"text-primary-500 mr-2",icon:"exchange-alt"}),H(I(p.Direction||"\u55AE\u5411"),1)]),i("span",null,[S(n,{class:"text-primary-500 mr-2",icon:"route"}),H(I(p.CyclingLength)+"\u516C\u5C3A",1)])]),i("p",null,[co,H(I(p.RoadSectionStart),1)]),i("p",null,[lo,H(I(p.RoadSectionEnd),1)]),E(" <button >\u67E5\u770B\u4F4D\u7F6E</button> ")],8,no))),128))])]),S(y)])}var uo=C(Qt,[["render",po]]);const yo={components:{MapRoute:Zt,RouteList:uo},setup(){const t=Z(null),o=Z(!1),a=V([]),e=U("isMobile"),s=V({keyword:"",city:ce[0].value,page:1,totalPage:1}),r=l=>{s.city=l},c=l=>{s.keyword=l},n=V([]),y=async()=>{n.length=0,a.length=0,console.log("singlePageList--route",a);const l={city:s.city,$filter:s.keyword?`contains(RouteName,'${s.keyword}')`:""};try{const m=await Rt(l);m.length>0&&(Object.assign(n,m),s.totalPage=Math.ceil(n.length/30),s.page=1,R())}catch(m){console.log("error",m)}},p=l=>{s.page=l,R()},K=()=>{y()},M=l=>{t.value.drawLine(l)},B=l=>{o.value=l};T("totalPage",ee(s,"totalPage")),T("page",ee(s,"page")),T("setPage",p),T("showStatus",o),T("setShowStatus",B);const R=()=>{const l=[...n],m=(s.page-1)*30,N=l.splice(m,30);Object.assign(a,N);const u=a[0];M(u.Geometry)};return q(()=>{}),W(A({},ie(s)),{updateCity:r,updateKeyword:c,singlePageList:a,getRoute:y,mapInstance:t,drawLine:M,search:K,isMobile:e,showStatus:o})}};function ho(t,o,a,e,s,r){const c=b("map-route"),n=b("route-list");return g(),w(D,null,[te(S(c,{ref:"mapInstance",city:t.city,singlePageList:e.singlePageList,onGetRoute:e.getRoute},null,8,["city","singlePageList","onGetRoute"]),[[oe,e.showStatus||!e.isMobile]]),te(S(n,{onSearch:e.search,onDrawLine:e.drawLine,onUpdateCity:e.updateCity,onUpdateKeyword:e.updateKeyword,singlePageList:e.singlePageList,keyword:t.keyword,city:t.city},null,8,["onSearch","onDrawLine","onUpdateCity","onUpdateKeyword","singlePageList","keyword","city"]),[[oe,!e.showStatus||!e.isMobile]])],64)}var go=C(yo,[["render",ho]]);const mo={components:{ViewBar:_e},props:{singlePageList:{type:Array,default:()=>[]}},emits:["mapReady"],setup(t,{emit:o}){const a=U("isMobile");let e=null,s=null,r=null,c=null,n=null;const y=()=>{let l="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";e=f.map("map"),f.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:l}).addTo(e),s=new f.MarkerClusterGroup().addTo(e),o("mapReady")},p=()=>{s.clearLayers(),e.eachLayer(l=>{l instanceof f.Marker&&e.removeLayer(l)})},K=(l,m)=>{e.setView([l,m],18),f.marker([l,m],{icon:r}).addTo(e).bindPopup("\u4F60\u5728\u9019\uFF5E").openPopup()},M=l=>{let{PositionLat:m,PositionLon:N}=l.StationPosition,{AvailableRentBikes:u,AvailableReturnBikes:L,UpdateTime:v,StationName:_,StationAddress:x,ServiceStatus:P}=l;f.popup().setLatLng([m,N]).openOn(e).setContent(`
            <h3 class="text-xl font-bold">
                ${_.Zh_tw}
            </h3>
            <h4 class="pt-2 text-sm">
                <i class="fas fa-map-marker-alt text-lg  text-primary-500"></i>
                ${x.Zh_tw}
            </h4>
            <p class="text-sm">
            <i class="fas fa-history text-lg text-primary-500"></i>
                ${de(v)}
            </p>
            <p class="py-2">
                <span class="${F(P,"color")}">
                    ${F(P,"type")}
                </span>
                <span
                    class="
                        ${u>0?"available":"no-available"}
                    "
                    >
                        ${u>0?"\u5C1A\u6709\u55AE\u8ECA":"\u5DF2\u7121\u55AE\u8ECA"}
                    </span>
            </p>
            <div class="rent-info flex items-center justify-between">
                <div class="w-1/2 md:h-24 h-16 flex flex-col justify-center rounded-md border-primary-500 mr-4 text-center border">
                    <p class="font-bold my-1 text-primary-500 text-base">\u53EF\u501F\u55AE\u8ECA</p>
                    <p class="font-bold text-2xl">
                        ${u}
                    </p>
                </div>
                <div class="w-1/2 md:h-24 h-16 flex flex-col justify-center rounded-md border-primary-500 text-center border">
                    <p class="font-bold text-primary-500 text-base">\u53EF\u505C\u7A7A\u4F4D</p>
                    <p class="font-bold text-2xl">
                        ${L}
                    </p>
                </div>
            </div> `),e.setView([m,N],18)},B=()=>{c=new f.Icon({iconUrl:"/images/mark/no_rent.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),n=new f.Icon({iconUrl:"/images/mark/bike.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),r=new f.Icon({iconUrl:"/images/mark/currentLocation.png",shadowUrl:"",iconSize:[40,41],iconAnchor:[12,41],popupAnchor:[1,-34]})},R=()=>{p(),t.singlePageList.forEach(l=>{let{PositionLat:m,PositionLon:N}=l.StationPosition,{AvailableRentBikes:u,AvailableReturnBikes:L,UpdateTime:v,StationName:_,StationAddress:x,ServiceStatus:P}=l;console.log("item",l);const d=u>0?n:c;f.marker([m,N],{icon:d}).addTo(e).bindPopup(`
                <h3 class="text-xl font-bold">
                    ${_.Zh_tw}
                </h3>
                <h4 class="pt-2 text-sm">
                    <i class="fas fa-map-marker-alt text-lg  text-primary-500"></i>
                    ${x.Zh_tw}
                </h4>
                <p class="text-sm">
                <i class="fas fa-history text-lg text-primary-500"></i>
                    ${de(v)}
                </p>
                <p class="py-2">
                    <span class="${F(P,"color")}">
                        ${F(P,"type")}
                    </span>
                    <span
                        class="
                            ${u>0?"available":"no-available"}
                        "
                        >
                            ${u>0?"\u5C1A\u6709\u55AE\u8ECA":"\u5DF2\u7121\u55AE\u8ECA"}
                        </span>
                </p>
                <div class="rent-info flex items-center justify-between">
                    <div class="w-1/2 h-24 flex flex-col justify-center rounded-md border-primary-500 mr-4 text-center border">
                        <p class="font-bold my-1 text-primary-500 text-base">\u53EF\u501F\u55AE\u8ECA</p>
                        <p class="font-bold text-2xl">
                            ${u}
                        </p>
                    </div>
                    <div class="w-1/2 h-24 flex flex-col justify-center rounded-md border-primary-500 text-center border">
                        <p class="font-bold text-primary-500 text-base">\u53EF\u505C\u7A7A\u4F4D</p>
                        <p class="font-bold text-2xl">
                            ${L}
                        </p>
                    </div>
                </div> `)})};return q(()=>{B(),y()}),he(()=>{e=null,s=null}),{drawSelfMark:K,drawMark:R,setView:M,transType:F,transTime:de,isMobile:a}}},_o=i("div",{id:"map",class:"map fixed z-10"},null,-1);function wo(t,o,a,e,s,r){const c=b("ViewBar");return g(),w(D,null,[_o,e.isMobile?(g(),se(c,{key:0})):E("v-if",!0)],64)}var fo=C(mo,[["render",wo]]);const vo={components:{Pagination:we,Search:le},props:{singlePageList:{type:Array,default:()=>[]},keyword:{type:String,default:""},city:{type:String,default:""}},emits:["setView","updateKeyword","updateCity","search"],setup(t,{emit:o}){const a=U("setShowStatus"),e=()=>{a(!0)};return{setView:y=>{o("setView",y),e()},updateCity:y=>{o("updateCity",y)},updateKeyword:y=>{o("updateKeyword",y)},search:()=>{o("search")},transType:F}}},bo={class:"h-full md:w-96 w-full fixed px-8 left-0 top-0 z-20 box-border pt-24 overflow-hidden bg-white"},So={class:"rounded-xl shadow-lg overflow-hidden"},xo=i("div",{class:"md:h-8 md:block hidden bg-primary-500"},null,-1),ko={class:"p-4"},Lo=i("h1",{class:"md:text-3xl hidden md:block font-bold mb-6"}," \u5C0B\u627E\u55AE\u8ECA ",-1),$o={class:"list overflow-y-scroll mt-8 md:mb-4"},Po={class:""},Ao={key:0,class:"text-center text-primary-500"},Io=["onClick"],Co={class:"text-xl font-bold"},Mo={class:"py-2"};function To(t,o,a,e,s,r){const c=b("Search"),n=b("font-awesome-icon"),y=b("pagination");return g(),w("div",null,[i("div",bo,[i("div",So,[xo,i("div",ko,[Lo,S(c,{onSearch:e.search,onUpdateCity:e.updateCity,onUpdateKeyword:e.updateKeyword,city:a.city,keyword:a.keyword},null,8,["onSearch","onUpdateCity","onUpdateKeyword","city","keyword"])])]),i("div",$o,[i("ul",Po,[a.singlePageList.length===0?(g(),w("li",Ao," \u67E5\u7121\u7D00\u9304 ")):E("v-if",!0),(g(!0),w(D,null,X(a.singlePageList,p=>(g(),w("li",{class:"bg-grey-100 rounded-xl mb-3 px-2 py-4 cursor-pointer",key:p.StationUID,onClick:K=>e.setView(p)},[i("h3",Co,I(p.StationName.Zh_tw),1),i("h4",null,[S(n,{icon:"map-marker-alt"}),H(" "+I(p.StationAddress.Zh_tw),1)]),i("p",Mo,[i("span",{class:ge(e.transType(p.ServiceStatus,"color"))},I(e.transType(p.ServiceStatus,"type")),3),i("span",{class:ge(p.AvailableRentBikes>0?"available":"no-available")},I(p.AvailableRentBikes>0?"\u5C1A\u6709\u55AE\u8ECA":"\u5DF2\u7121\u55AE\u8ECA"),3)]),E(" <button >\u67E5\u770B\u4F4D\u7F6E</button> ")],8,Io))),128))])]),S(y)])])}var Uo=C(vo,[["render",To]]);const Bo={components:{MapBike:fo,BikeList:Uo},setup(){const t=Z(null),o=Z(!1),a=Te(),e=U("isMobile"),s=V({keyword:"",city:ce[0].value,page:1,totalPage:1}),r=d=>{s.city=d},c=d=>{s.keyword=d},n=()=>{const d=a.query.city;d&&(s.city=d);const h=a.query.keyword;h&&(s.keyword=h),d||h?R():(console.log("getNowPos!!!"),L())},y=U("setShowLoading"),p=d=>{y(d)},K=()=>{R()},M=V([]);let B=V([]);const R=async()=>{B.length=0;const d={city:s.city,$filter:s.keyword?`contains(StationName/Zh_tw,'${s.keyword}')`:""};try{const h=await Ut(d);Object.assign(M,h),h.length>0&&N()}catch(h){console.log("error",h)}},l=async({longitude:d,latitude:h})=>{Object.assign(B,[]);const $={city:s.city,$spatialFilter:`nearby(${h},${d},${500})`};try{const k=await Nt($);Object.assign(M,k),k.length>0&&u(d,h)}catch(k){console.log("error",k)}},m=V([]),N=async()=>{p(!0);const d={city:s.city};try{const h=await Bt(d);let $=M.filter(k=>h.some(O=>k.StationUID===O.StationUID));$.forEach((k,O)=>{h.forEach(z=>{k.StationUID===z.StationUID&&($[O]=A(A({},k),z))})}),Object.assign(m,$),s.totalPage=Math.ceil(m.length/30),s.page=1,x()}catch(h){console.log("error",h)}p(!1)},u=async(d,h)=>{p(!0);const $={$spatialFilter:`nearby(${h},${d},${500})`};try{const k=await Kt($);k.forEach(O=>{M.forEach(z=>{z.StationUID===O.StationUID&&(O.StationName=z.StationName,O.StationPosition=z.StationPosition,O.StationAddress=z.StationAddress)})}),Object.assign(m,k),s.totalPage=Math.ceil(m.length/30),s.page=1,x()}catch(k){console.log("error",k)}p(!1)},L=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(d=>{const h=d.coords.longitude,$=d.coords.latitude;t.value.drawSelfMark($,h),l({longitude:h,latitude:$})},d=>{const{code:h,message:$}=d;console.log("error",`code=${h}, msg=${$}`),R()})},v=d=>{s.page=d,x()},_=d=>{o.value=d};T("totalPage",ee(s,"totalPage")),T("page",ee(s,"page")),T("setPage",v),T("showStatus",o),T("setShowStatus",_);const x=()=>{const d=[...m],h=(s.page-1)*30,$=d.splice(h,30);Object.assign(B,$),t.value.drawMark();const k=B[0];P(k)},P=d=>{t.value.setView(d)};return q(()=>{}),W(A({},ie(s)),{getNearByInfo:l,availableList:m,mapReady:n,mapInstance:t,updateCity:r,singlePageList:B,updateKeyword:c,setView:P,search:K,showStatus:o,isMobile:e})}};function Ro(t,o,a,e,s,r){const c=b("map-bike"),n=b("bike-list");return g(),w("div",null,[te(S(c,{ref:"mapInstance",singlePageList:e.singlePageList,onMapReady:e.mapReady},null,8,["singlePageList","onMapReady"]),[[oe,e.showStatus||!e.isMobile]]),te(S(n,{onSearch:e.search,onSetView:e.setView,onUpdateCity:e.updateCity,onUpdateKeyword:e.updateKeyword,singlePageList:e.singlePageList,city:t.city,keyword:t.keyword},null,8,["onSearch","onSetView","onUpdateCity","onUpdateKeyword","singlePageList","city","keyword"]),[[oe,!e.showStatus||!e.isMobile]])])}var No=C(Bo,[["render",Ro]]);const Ko=[{path:"/",name:"Index",component:Mt},{path:"/route",name:"Route",component:go},{path:"/bike",name:"Bike",component:No}],Do=Ue({history:Be(),routes:Ko});function jo(t){const a={tId:adminUse.Cookie("cAa")};t.commit("updLoading",!0),adminUse.getAjax(t.state.config.groupPath.platformAdmin+"/backLogOut",a).then(e=>{t.commit("updLoading",!1),e.resultCode=="000"?(adminUse.Cookie("remove","cAa"),t.commit("updMenuList",""),t.commit("updUserName",""),t.commit("updIsLogin",!1),adminUse.showToast(e.msg),router.push("/login")):adminUse.showToast(e.msg+"("+e.resultCode+")","red")})}var Oo=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",logout:jo});const Vo=new Re({storage:window.localStorage,reducer:t=>({myPlatformId:t.myPlatformId})}),zo=()=>({config:{}});var Eo=Ne({state:zo,mutations:{updBeep(t,o){t.beep=o}},actions:Oo,plugins:[Vo.plugin],modules:{}});J.add(Ke);J.add(De);J.add(je);J.add(Oe);J.add(Ve);const fe=ze(rt);fe.component("font-awesome-icon",Ee);fe.use(Eo).use(Do).use(He).mount("#app");
