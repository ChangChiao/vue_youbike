var be=Object.defineProperty,Se=Object.defineProperties;var xe=Object.getOwnPropertyDescriptors;var ue=Object.getOwnPropertySymbols;var ke=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var ye=(t,o,a)=>o in t?be(t,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[o]=a,I=(t,o)=>{for(var a in o||(o={}))ke.call(o,a)&&ye(t,a,o[a]);if(ue)for(var a of ue(o))Le.call(o,a)&&ye(t,a,o[a]);return t},X=(t,o)=>Se(t,xe(o));import{u as he,r as b,o as y,c as m,a as i,F as D,b as ee,d as S,w as $e,e as z,f as O,t as M,g as re,T as Pe,p as ie,h as ce,i as Z,j as U,k as J,l as E,m as le,n as Ae,q as Ce,s as Ie,v as N,x as ge,L as w,y as Me,z as Te,A as te,B as oe,C as ae,D as me,E as Ue,G as Ne,H as Be,V as Re,I as Ke,J as Q,K as De,M as je,N as Ve,O as ze,P as Oe,Q as Ee,R as He,S as Ye}from"./vendor.be70ef7c.js";const Ge=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&e(c)}).observe(document,{childList:!0,subtree:!0});function a(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function e(s){if(s.ep)return;s.ep=!0;const r=a(s);fetch(s.href,r)}};Ge();var _e="./images/logo.png";var T=(t,o)=>{for(const[a,e]of o)t[a]=e;return t};const Ze={setup(){const t=he();return{menuList:[{title:"\u5C0B\u627E\u55AE\u8ECA",path:"/bike"},{title:"\u5C0B\u627E\u8ECA\u9053",path:"/route"}],goHome:()=>{t.push("/")}}}},Fe={class:"flex relative z-50 justify-between shadow-lg items-center px-3 font-medium h-20"},qe={class:"menu flex"};function Je(t,o,a,e,s,r){const c=b("router-link");return y(),m("header",Fe,[i("img",{class:"w-20 cursor-pointer",src:_e,alt:"",onClick:o[0]||(o[0]=(...n)=>e.goHome&&e.goHome(...n))}),i("ul",qe,[(y(!0),m(D,null,ee(e.menuList,n=>(y(),m("li",{class:"mx-3 :mdtext-lg text-md text-primary-500",key:n.path},[S(c,{to:n.path,class:"duration-200"},{default:$e(()=>[O(M(n.title),1)]),_:2},1032,["to"])]))),128))]),z(` <font-awesome-icon
            class="for-mobile text-lg text-gray-500"
            icon="search"
        /> `)])}var Qe=T(Ze,[["render",Je],["__scopeId","data-v-61dd7a3d"]]);const We={props:{showLoading:{type:Boolean,default:null}},setup(){}},Xe=t=>(ie("data-v-efe9d588"),t=t(),ce(),t),et={key:0,class:"loading-wrap"},tt=Xe(()=>i("svg",{class:"spinner",width:"65px",height:"65px",viewBox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg"},[i("circle",{class:"path",fill:"none","stroke-width":"6","stroke-linecap":"round",cx:"33",cy:"33",r:"30"})],-1)),ot=[tt];function at(t,o,a,e,s,r){return y(),re(Pe,{to:"#teleport-target"},[a.showLoading?(y(),m("div",et,ot)):z("v-if",!0)])}var st=T(We,[["render",at],["__scopeId","data-v-efe9d588"]]);const nt={components:{Loading:st,Header:Qe},setup(){const t=Z(!1),o=Z(0);return U("setShowLoading",e=>{t.value=e}),U("isMobile",o),J(()=>{o.value=window.innerWidth<768}),{showLoading:t}}};function rt(t,o,a,e,s,r){const c=b("Header"),n=b("router-view"),_=b("loading");return y(),m(D,null,[S(c),S(n),S(_,{showLoading:e.showLoading},null,8,["showLoading"])],64)}var it=T(nt,[["render",rt]]);const Y="https://ptx.transportdata.tw/MOTC/v2",ct=Y+"/Bike/Station",lt=Y+"/Bike/Availability",dt=Y+"/Cycling/Shape",pt=Y+"/Bike/Station/NearBy",ut=Y+"/Bike/Availability/NearBy",yt=Y+"/Tourism/ScenicSpot",ht=Y+"/Tourism/Restaurant",se=[{label:"\u81FA\u5317\u5E02",value:"Taipei"},{label:"\u65B0\u5317\u5E02",value:"NewTaipei"},{label:"\u6843\u5712\u5E02",value:"Taoyuan"},{label:"\u81FA\u4E2D\u5E02",value:"Taichung"},{label:"\u81FA\u5357\u5E02",value:"Tainan"},{label:"\u9AD8\u96C4\u5E02",value:"Kaohsiung"},{label:"\u82D7\u6817\u7E23",value:"MiaoliCounty"},{label:"\u5609\u7FA9\u5E02",value:"Chiayi"},{label:"\u5C4F\u6771\u7E23",value:"PingtungCounty"},{label:"\u91D1\u9580\u7E23",value:"KinmenCounty"}],gt={props:{city:{type:String,default:""},keyword:{type:String,default:""}},emits:["updateCity","updateKeyword","search"],setup(t,{emit:o}){return{CITY_LIST:se,updateKeyword:r=>{o("updateKeyword",r.target.value)},updateCity:r=>{o("updateCity",r.target.value)},search:()=>{o("search")}}}},mt={class:"input-box py-2"},_t=["value"],wt={class:"flex pt-3"},ft=["value"],vt=["value"];function bt(t,o,a,e,s,r){const c=b("font-awesome-icon");return y(),m(D,null,[i("div",mt,[S(c,{class:"text-gray-500",icon:"search"}),i("input",{class:"w-1/2 pl-4",placeholder:"\u8F38\u5165\u95DC\u9375\u5B57",value:a.keyword,onInput:o[0]||(o[0]=(...n)=>e.updateKeyword&&e.updateKeyword(...n)),type:"text"},null,40,_t)]),i("div",wt,[i("select",{class:"w-1/2",value:a.city,onChange:o[1]||(o[1]=(...n)=>e.updateCity&&e.updateCity(...n))},[z(' <option value="">\u7E23\u5E02</option> '),(y(!0),m(D,null,ee(e.CITY_LIST,n=>(y(),m("option",{key:n.value,value:n.value},M(n.label),9,vt))),128))],40,ft),i("button",{onClick:o[2]||(o[2]=(...n)=>e.search&&e.search(...n)),class:"ml-2 w-1/2 cursor-pointer"},"\u641C\u5C0B")])],64)}var de=T(gt,[["render",bt]]),St="./images/illustration.png";const xt={components:{Search:de},setup(){const t=he(),o=E({city:se[0].value,keyword:""}),a=r=>{o.city=r},e=r=>{o.keyword=r},s=()=>{t.push({path:"/bike",query:{keyword:o.keyword,city:o.city}})};return X(I({},le(o)),{search:s,updateCity:a,updateKeyword:e})}},ne=t=>(ie("data-v-c221866a"),t=t(),ce(),t),kt={class:"cover relative bg-primary-100"},Lt={class:"search w-4/5 m-auto md:ml-40 pt-12 md:w-96 relative z-10"},$t=ne(()=>i("img",{class:"w-60",src:_e,alt:""},null,-1)),Pt=ne(()=>i("p",{class:"text-2xl text-primary-500 font-extrabold"},"\u5C0B\u627E\u55AE\u8ECA,",-1)),At=ne(()=>i("p",{class:"text-2xl text-primary-500 font-extrabold pb-4"}," \u4F86\u5834\u60A0\u9592\u7684\u653E\u9B06\u4E4B\u65C5\uFF01 ",-1)),Ct=ne(()=>i("img",{class:"fixed bottom-10 md:w-2/3 left-0 right-0 mx-auto md:bottom-40",src:St},null,-1));function It(t,o,a,e,s,r){const c=b("Search");return y(),m("div",kt,[i("div",Lt,[$t,Pt,At,S(c,{onUpdateCity:e.updateCity,onUpdateKeyword:e.updateKeyword,onSearch:e.search,city:t.city,keyword:t.keyword},null,8,["onUpdateCity","onUpdateKeyword","onSearch","city","keyword"])]),Ct])}var Mt=T(xt,[["render",It],["__scopeId","data-v-c221866a"]]);const Tt=(t,o="success")=>{t&&console.log(t,o)},pe=t=>{let o=new Date(t);return Ae(o).format("YYYY-MM-DD HH:mm:ss")},F=(t,o)=>{let a="",e="";switch(t){case 0:a="no-available",e="\u505C\u6B62\u71DF\u904B";break;case 1:a="available",e="\u6B63\u5E38\u71DF\u904B";break;case 2:a="no-rent",e="\u66AB\u505C\u71DF\u904B";break}return o==="color"?a:e},j=Ce.create({});j.interceptors.request.use(t=>{let o=t.params;return Object.keys(o).map(a=>{o[a]||delete o[a]}),t},t=>t);j.interceptors.response.use(t=>t.data,t=>{const{status:o}=t.response;return Tt(`error--${o}`,"error"),Promise.reject(t)});const G=()=>{let t="b65665fcca144956a79d25bb3edc7b34",o="daVxLDO01nPgTTwhQKVBmY-pjeQ";const a=new Date().toGMTString(),e=new Ie("SHA-1","TEXT");e.setHMACKey(o,"TEXT"),e.update("x-date: "+a);let s=e.getHMAC("B64");return{Authorization:`hmac username="${t}", algorithm="hmac-sha1", headers="x-date", signature="${s}"`,"X-Date":a,"Content-Type":"application/x-www-form-urlencoded"}},W=t=>{const{city:o}=t;return delete t.city,{cityPath:o,data:t}},Ut=t=>{const{cityPath:o,data:a}=W(t);let e={headers:G(),params:I({},a)};return j.get(ct+`/${o}`,e)},Nt=t=>{const{cityPath:o,data:a}=W(t);let e={headers:G(),params:I({},a)};return j.get(lt+`/${o}`,e)},Bt=t=>{const{cityPath:o,data:a}=W(t);let e={headers:G(),params:I({},a)};return j.get(dt+`/${o}`,e)},Rt=t=>{let o={headers:G(),params:I({},t)};return j.get(pt,o)},Kt=t=>{let o={headers:G(),params:I({},t)};return j.get(ut,o)},Dt=t=>{const{cityPath:o,data:a}=W(t);let e={headers:G(),params:I({},a)};return j.get(ht+`/${o}`,e)},jt=t=>{const{cityPath:o,data:a}=W(t);let e={headers:G(),params:I({},a)};return j.get(yt+`/${o}`,e)},Vt={emit:[],setup(){const t=N("showStatus"),o=N("setShowStatus");return{showStatus:t,controlStatus:()=>{o(!1)}}}},zt={class:"fixed for-mobile-flex flex-wrap flex justify-center items-center w-screen h-12 shadow-lg bottom-0 bg-white z-10"};function Ot(t,o,a,e,s,r){return y(),m("div",zt,[i("button",{class:"h-8 w-1/2 text-primary-500 text-sm available",onClick:o[0]||(o[0]=c=>e.controlStatus())}," \u986F\u793A\u5217\u8868 ")])}var we=T(Vt,[["render",Ot]]);const Et={components:{ViewBar:we},props:{city:{type:String,default:""}},emits:["getRoute"],setup(t,{emit:o}){const a=N("isMobile");let e=null,s=null,r=null,c=null,n=null;const _=()=>{let u="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";e=w.map("map_route"),w.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:u}).addTo(e),n=new w.MarkerClusterGroup().addTo(e),d()},l=()=>{n.clearLayers(),e.eachLayer(u=>{u instanceof w.Marker&&e.removeLayer(u)})},R=u=>{let g=u.replace("MULTILINESTRING ((","").replace("))","").split(",");const $=g[0]&&g[0].split(" "),C=g[g.length-1]&&g[g.length-1].split(" ");n.addLayer(w.marker([$[1],$[0]],{icon:s})),n.addLayer(w.marker([C[1],C[0]],{icon:s})),e.addLayer(n),B($[1],$[0]),K($[1],$[0])},A=(u,x)=>{u.forEach(v=>{const{PositionLon:g,PositionLat:$}=v.Position;let C=x==="food"?r:c;n.addLayer(w.marker([$,g],{icon:C}).bindPopup(`<h1>${v.Name}</h1>
                        <p>${v.OpenTime}</p>
                        `))}),e.addLayer(n)},B=async(u,x)=>{const v={city:t.city,$spatialFilter:`nearby(${u},${x},${500})`};try{const g=await jt(v);A(g,"spot")}catch(g){console.log("error",g)}},K=async(u,x)=>{try{const v={city:t.city,$spatialFilter:`nearby(${u},${x},${500})`},g=await Dt(v);A(g,"food")}catch(v){console.log("error",v)}},d=()=>{o("getRoute")},f=()=>{s=new w.Icon({iconUrl:"./images/mark/no_rent.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),r=new w.Icon({iconUrl:"./images/mark/food.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),c=new w.Icon({iconUrl:"./images/mark/spot.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]})},k=u=>{console.log("Geometry",u),l();const x=new Me.exports.Wkt;x.read(u);const v=x.toJson(),g={color:"#C50047",weight:5};n=w.geoJSON(v,{style:g}).addTo(e),n.addData(v),e.fitBounds(n.getBounds()),e.addLayer(n),R(u)};return J(()=>{f(),_()}),ge(()=>{e=null,n=null}),{drawLine:k,isMobile:a}}},Ht=t=>(ie("data-v-3aad47fd"),t=t(),ce(),t),Yt=Ht(()=>i("div",{id:"map_route",class:"map fixed z-10"},null,-1));function Gt(t,o,a,e,s,r){const c=b("ViewBar");return y(),m(D,null,[Yt,e.isMobile?(y(),re(c,{key:0})):z("v-if",!0)],64)}var Zt=T(Et,[["render",Gt],["__scopeId","data-v-3aad47fd"]]);const Ft={components:{VPagination:Te},setup(){const t=N("page"),o=N("totalPage"),a=N("setPage");return{page:t,totalPage:o,updateHandler:s=>{a(s)}}}},qt={class:"pt-4 flex justify-center"};function Jt(t,o,a,e,s,r){const c=b("v-pagination");return y(),m("div",qt,[S(c,{"v-model":e.page,pages:e.totalPage,"range-size":1,"active-color":"#DCEDFF","onUpdate:modelValue":e.updateHandler},null,8,["v-model","pages","onUpdate:modelValue"])])}var fe=T(Ft,[["render",Jt]]);const Qt={components:{Pagination:fe,Search:de},props:{singlePageList:{type:Array,default:()=>[]},keyword:{type:String,default:""},city:{type:String,default:""}},emits:["drawLine","updateKeyword","updateCity","search"],setup(t,{emit:o}){const a=N("setShowStatus"),e=()=>{a(!0)};return{drawLine:_=>{o("drawLine",_),e()},updateCity:_=>{o("updateCity",_)},updateKeyword:_=>{o("updateKeyword",_)},search:()=>{o("search")}}}},Wt={class:"h-full md:w-96 w-full fixed px-8 left-0 top-0 z-20 box-border pt-24 overflow-hidden bg-white"},Xt={class:"rounded-xl shadow-lg overflow-hidden"},eo=i("div",{class:"md:h-8 hidden md:block bg-primary-500"},null,-1),to={class:"p-4"},oo=i("h1",{class:"md:text-3xl hidden md:block font-bold mb-6"}," \u5C0B\u627E\u8ECA\u9053 ",-1),ao={class:"list overflow-y-scroll mt-8 md:mb-4"},so={class:""},no=["onClick"],ro={class:"text-xl font-bold pb-2"},io={class:"mr-8"},co=i("span",{class:"sub-title"},"\u958B\u59CB",-1),lo=i("span",{class:"sub-title"},"\u7D50\u675F",-1);function po(t,o,a,e,s,r){const c=b("Search"),n=b("font-awesome-icon"),_=b("pagination");return y(),m("div",Wt,[i("div",Xt,[eo,i("div",to,[oo,S(c,{onSearch:e.search,onUpdateCity:e.updateCity,onUpdateKeyword:e.updateKeyword,city:a.city,keyword:a.keyword},null,8,["onSearch","onUpdateCity","onUpdateKeyword","city","keyword"])])]),i("div",ao,[i("ul",so,[(y(!0),m(D,null,ee(a.singlePageList,l=>(y(),m("li",{class:"bg-grey-100 rounded-xl mb-3 px-2 py-4 cursor-pointer",key:l.StationUID,onClick:R=>e.drawLine(l.Geometry)},[i("h3",ro,M(l.RouteName),1),i("h4",null,[S(n,{class:"text-primary-500",icon:"map-marker-alt"}),O(" "+M(l.City)+" "+M(l.Town||""),1)]),i("p",null,[i("span",io,[S(n,{class:"text-primary-500 mr-2",icon:"exchange-alt"}),O(M(l.Direction||"\u55AE\u5411"),1)]),i("span",null,[S(n,{class:"text-primary-500 mr-2",icon:"route"}),O(M(l.CyclingLength)+"\u516C\u5C3A",1)])]),i("p",null,[co,O(M(l.RoadSectionStart),1)]),i("p",null,[lo,O(M(l.RoadSectionEnd),1)]),z(" <button >\u67E5\u770B\u4F4D\u7F6E</button> ")],8,no))),128))])]),S(_)])}var uo=T(Qt,[["render",po]]);const yo={components:{MapRoute:Zt,RouteList:uo},setup(){const t=Z(null),o=Z(!1),a=E([]),e=N("isMobile"),s=E({keyword:"",city:se[0].value,page:1,totalPage:1}),r=d=>{s.city=d},c=d=>{s.keyword=d},n=E([]),_=async()=>{n.length=0,a.length=0,console.log("singlePageList--route",a);const d={city:s.city,$filter:s.keyword?`contains(RouteName,'${s.keyword}')`:""};try{const f=await Bt(d);f.length>0&&(Object.assign(n,f),s.totalPage=Math.ceil(n.length/30),s.page=1,K())}catch(f){console.log("error",f)}},l=d=>{s.page=d,K()},R=()=>{_()},A=d=>{t.value.drawLine(d)},B=d=>{o.value=d};U("totalPage",te(s,"totalPage")),U("page",te(s,"page")),U("setPage",l),U("showStatus",o),U("setShowStatus",B);const K=()=>{const d=[...n],f=(s.page-1)*30,k=d.splice(f,30);Object.assign(a,k);const u=a[0];A(u.Geometry)};return J(()=>{}),X(I({},le(s)),{updateCity:r,updateKeyword:c,singlePageList:a,getRoute:_,mapInstance:t,drawLine:A,search:R,isMobile:e,showStatus:o})}};function ho(t,o,a,e,s,r){const c=b("map-route"),n=b("route-list");return y(),m(D,null,[oe(S(c,{ref:"mapInstance",city:t.city,singlePageList:e.singlePageList,onGetRoute:e.getRoute},null,8,["city","singlePageList","onGetRoute"]),[[ae,e.showStatus||!e.isMobile]]),oe(S(n,{onSearch:e.search,onDrawLine:e.drawLine,onUpdateCity:e.updateCity,onUpdateKeyword:e.updateKeyword,singlePageList:e.singlePageList,keyword:t.keyword,city:t.city},null,8,["onSearch","onDrawLine","onUpdateCity","onUpdateKeyword","singlePageList","keyword","city"]),[[ae,!e.showStatus||!e.isMobile]])],64)}var go=T(yo,[["render",ho]]);const mo={components:{ViewBar:we},props:{singlePageList:{type:Array,default:()=>[]}},emits:["mapReady"],setup(t,{emit:o}){const a=N("isMobile");let e=null,s=null,r=null,c=null,n=null;const _=()=>{let d="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";e=w.map("map"),w.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:d}).addTo(e),s=new w.MarkerClusterGroup().addTo(e),o("mapReady")},l=()=>{s.clearLayers(),e.eachLayer(d=>{d instanceof w.Marker&&e.removeLayer(d)})},R=(d,f)=>{e.setView([d,f],18),w.marker([d,f],{icon:r}).addTo(e).bindPopup("\u4F60\u5728\u9019\uFF5E").openPopup()},A=d=>{let{PositionLat:f,PositionLon:k}=d.StationPosition,{AvailableRentBikes:u,AvailableReturnBikes:x,UpdateTime:v,StationName:g,StationAddress:$,ServiceStatus:C}=d;w.popup().setLatLng([f,k]).openOn(e).setContent(`
            <h3 class="text-xl font-bold">
                ${g.Zh_tw}
            </h3>
            <h4 class="pt-2 text-sm">
                <i class="fas fa-map-marker-alt text-lg  text-primary-500"></i>
                ${$.Zh_tw}
            </h4>
            <p class="text-sm">
            <i class="fas fa-history text-lg text-primary-500"></i>
                ${pe(v)}
            </p>
            <p class="py-2">
                <span class="${F(C,"color")}">
                    ${F(C,"type")}
                </span>
                <span
                    class="
                        ${u>0?"available":"no-available"}
                    "
                    >
                        ${u>0?"\u5C1A\u6709\u55AE\u8ECA":"\u5DF2\u7121\u55AE\u8ECA"}
                    </span>
            </p>
            <div class="rent-info flex items-center justify-between">
                <div class="w-1/2 md:h-24 h-16 flex flex-col justify-center rounded-md border-primary-500 mr-4 text-center border">
                    <p class="font-bold my-1 text-primary-500 text-base">\u53EF\u501F\u55AE\u8ECA</p>
                    <p class="font-bold text-2xl">
                        ${u}
                    </p>
                </div>
                <div class="w-1/2 md:h-24 h-16 flex flex-col justify-center rounded-md border-primary-500 text-center border">
                    <p class="font-bold text-primary-500 text-base">\u53EF\u505C\u7A7A\u4F4D</p>
                    <p class="font-bold text-2xl">
                        ${x}
                    </p>
                </div>
            </div> `),e.setView([f,k],18)},B=()=>{c=new w.Icon({iconUrl:"./images/mark/no_rent.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),n=new w.Icon({iconUrl:"./images/mark/bike.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),r=new w.Icon({iconUrl:"./images/mark/currentLocation.png",shadowUrl:"",iconSize:[40,41],iconAnchor:[12,41],popupAnchor:[1,-34]})},K=d=>{l(),d.forEach(f=>{let{PositionLat:k,PositionLon:u}=f.StationPosition,{AvailableRentBikes:x,AvailableReturnBikes:v,UpdateTime:g,StationName:$,StationAddress:C,ServiceStatus:q}=f;const p=x>0?n:c;s.addLayer(w.marker([k,u],{icon:p}).bindPopup(`
                <h3 class="text-xl font-bold">
                    ${$.Zh_tw}
                </h3>
                <h4 class="pt-2 text-sm">
                    <i class="fas fa-map-marker-alt text-lg  text-primary-500"></i>
                    ${C.Zh_tw}
                </h4>
                <p class="text-sm">
                <i class="fas fa-history text-lg text-primary-500"></i>
                    ${pe(g)}
                </p>
                <p class="py-2">
                    <span class="${F(q,"color")}">
                        ${F(q,"type")}
                    </span>
                    <span
                        class="
                            ${x>0?"available":"no-available"}
                        "
                        >
                            ${x>0?"\u5C1A\u6709\u55AE\u8ECA":"\u5DF2\u7121\u55AE\u8ECA"}
                        </span>
                </p>
                <div class="rent-info flex items-center justify-between">
                    <div class="w-1/2 h-24 flex flex-col justify-center rounded-md border-primary-500 mr-4 text-center border">
                        <p class="font-bold my-1 text-primary-500 text-base">\u53EF\u501F\u55AE\u8ECA</p>
                        <p class="font-bold text-2xl">
                            ${x}
                        </p>
                    </div>
                    <div class="w-1/2 h-24 flex flex-col justify-center rounded-md border-primary-500 text-center border">
                        <p class="font-bold text-primary-500 text-base">\u53EF\u505C\u7A7A\u4F4D</p>
                        <p class="font-bold text-2xl">
                            ${v}
                        </p>
                    </div>
                </div> `))}),e.addLayer(s)};return J(()=>{B(),_()}),ge(()=>{e=null,s=null}),{drawSelfMark:R,drawMark:K,setView:A,transType:F,transTime:pe,isMobile:a}}},_o=i("div",{id:"map",class:"map fixed z-10"},null,-1);function wo(t,o,a,e,s,r){const c=b("ViewBar");return y(),m(D,null,[_o,e.isMobile?(y(),re(c,{key:0})):z("v-if",!0)],64)}var fo=T(mo,[["render",wo]]);const vo={components:{Pagination:fe,Search:de},props:{singlePageList:{type:Array,default:()=>[]},keyword:{type:String,default:""},city:{type:String,default:""}},emits:["setView","updateKeyword","updateCity","search","getNowPos"],setup(t,{emit:o}){const a=N("setShowStatus"),e=()=>{a(!0)};return{setView:l=>{o("setView",l),e()},updateCity:l=>{o("updateCity",l)},updateKeyword:l=>{o("updateKeyword",l)},search:()=>{o("search")},transType:F,getNowPos:()=>{o("getNowPos")}}}},bo={class:"h-full md:w-96 w-full fixed px-8 left-0 top-0 z-20 box-border pt-24 overflow-hidden bg-white"},So={class:"rounded-xl shadow-lg overflow-hidden"},xo=i("div",{class:"md:h-8 md:block hidden bg-primary-500"},null,-1),ko={class:"p-4"},Lo={class:"md:text-3xl text-2xl font-bold md:mb-6 mb-2 flex justify-between items-center"},$o=O(" \u5C0B\u627E\u55AE\u8ECA "),Po={class:"list overflow-y-scroll mt-8 md:mb-4"},Ao={class:""},Co={key:0,class:"text-center text-primary-500"},Io=["onClick"],Mo={class:"text-xl font-bold"},To={class:"py-2"};function Uo(t,o,a,e,s,r){const c=b("Search"),n=b("font-awesome-icon"),_=b("pagination");return y(),m("div",null,[i("div",bo,[i("div",So,[xo,i("div",ko,[i("h1",Lo,[$o,i("i",{class:"fas fa-crosshairs text-primary-300 cursor-pointer",onClick:o[0]||(o[0]=(...l)=>e.getNowPos&&e.getNowPos(...l))})]),S(c,{onSearch:e.search,onUpdateCity:e.updateCity,onUpdateKeyword:e.updateKeyword,city:a.city,keyword:a.keyword},null,8,["onSearch","onUpdateCity","onUpdateKeyword","city","keyword"])])]),i("div",Po,[i("ul",Ao,[a.singlePageList.length===0?(y(),m("li",Co," \u67E5\u7121\u7D00\u9304 ")):z("v-if",!0),(y(!0),m(D,null,ee(a.singlePageList,l=>(y(),m("li",{class:"bg-grey-100 rounded-xl mb-3 px-2 py-4 cursor-pointer",key:l.StationUID,onClick:R=>e.setView(l)},[i("h3",Mo,M(l.StationName.Zh_tw),1),i("h4",null,[S(n,{icon:"map-marker-alt"}),O(" "+M(l.StationAddress.Zh_tw),1)]),i("p",To,[i("span",{class:me(e.transType(l.ServiceStatus,"color"))},M(e.transType(l.ServiceStatus,"type")),3),i("span",{class:me(l.AvailableRentBikes>0?"available":"no-available")},M(l.AvailableRentBikes>0?"\u5C1A\u6709\u55AE\u8ECA":"\u5DF2\u7121\u55AE\u8ECA"),3)]),z(" <button >\u67E5\u770B\u4F4D\u7F6E</button> ")],8,Io))),128))])]),S(_)])])}var No=T(vo,[["render",Uo]]);const Bo={components:{MapBike:fo,BikeList:No},setup(){const t=Z(null),o=Z(!1),a=Ue(),e=N("isMobile"),s=E({keyword:"",city:se[0].value,page:1,totalPage:1}),r=p=>{s.city=p},c=p=>{s.keyword=p},n=()=>{const p=a.query.city;p&&(s.city=p);const h=a.query.keyword;h&&(s.keyword=h),d()},_=N("setShowLoading"),l=p=>{_(p)},R=()=>{d()},A=E([]);let B=E([]);const K=()=>{A.length=0,k.length=0,B.length=0},d=async()=>{K();const p={city:s.city,$filter:s.keyword?`contains(StationName/Zh_tw,'${s.keyword}')`:""};try{const h=await Ut(p);Object.assign(A,h),h.length>0&&u()}catch(h){console.log("error",h)}},f=async({longitude:p,latitude:h})=>{K();const P={city:s.city,$spatialFilter:`nearby(${h},${p},${500})`};try{const L=await Rt(P);Object.assign(A,L),L.length>0&&x(p,h)}catch(L){console.log("error",L)}},k=E([]),u=async()=>{l(!0);const p={city:s.city};try{const h=await Nt(p);let P=A.filter(L=>h.some(V=>L.StationUID===V.StationUID));P.forEach((L,V)=>{h.forEach(H=>{L.StationUID===H.StationUID&&(P[V]=I(I({},L),H))})}),Object.assign(k,P),s.totalPage=Math.ceil(k.length/30),s.page=1,C()}catch(h){console.log("error",h)}l(!1)},x=async(p,h)=>{l(!0);const P={$spatialFilter:`nearby(${h},${p},${500})`};try{const L=await Kt(P);L.forEach(V=>{A.forEach(H=>{H.StationUID===V.StationUID&&(V.StationName=H.StationName,V.StationPosition=H.StationPosition,V.StationAddress=H.StationAddress)})}),Object.assign(k,L),s.totalPage=Math.ceil(k.length/30),s.page=1,C()}catch(L){console.log("error",L)}l(!1)},v=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(p=>{const h=p.coords.longitude,P=p.coords.latitude;t.value.drawSelfMark(P,h),f({longitude:h,latitude:P})},p=>{const{code:h,message:P}=p;console.log("error",`code=${h}, msg=${P}`),d()})},g=p=>{s.page=p,C()},$=p=>{o.value=p};U("totalPage",te(s,"totalPage")),U("page",te(s,"page")),U("setPage",g),U("showStatus",o),U("setShowStatus",$);const C=()=>{const p=[...k],h=(s.page-1)*30,P=p.splice(h,30);Object.assign(B,P),t.value.drawMark(B);const L=B[0];q(L)},q=p=>{t.value.setView(p)};return J(()=>{}),X(I({},le(s)),{getNearByInfo:f,availableList:k,mapReady:n,mapInstance:t,updateCity:r,singlePageList:B,updateKeyword:c,setView:q,search:R,showStatus:o,isMobile:e,getNowPos:v})}};function Ro(t,o,a,e,s,r){const c=b("map-bike"),n=b("bike-list");return y(),m("div",null,[oe(S(c,{ref:"mapInstance",singlePageList:e.singlePageList,onMapReady:e.mapReady},null,8,["singlePageList","onMapReady"]),[[ae,e.showStatus||!e.isMobile]]),oe(S(n,{onSearch:e.search,onSetView:e.setView,onUpdateCity:e.updateCity,onUpdateKeyword:e.updateKeyword,onGetNowPos:e.getNowPos,singlePageList:e.singlePageList,city:t.city,keyword:t.keyword},null,8,["onSearch","onSetView","onUpdateCity","onUpdateKeyword","onGetNowPos","singlePageList","city","keyword"]),[[ae,!e.showStatus||!e.isMobile]])])}var Ko=T(Bo,[["render",Ro]]);const Do=[{path:"/",name:"Index",component:Mt},{path:"/route",name:"Route",component:go},{path:"/bike",name:"Bike",component:Ko}],jo=Ne({history:Be(),routes:Do});function Vo(t){const a={tId:adminUse.Cookie("cAa")};t.commit("updLoading",!0),adminUse.getAjax(t.state.config.groupPath.platformAdmin+"/backLogOut",a).then(e=>{t.commit("updLoading",!1),e.resultCode=="000"?(adminUse.Cookie("remove","cAa"),t.commit("updMenuList",""),t.commit("updUserName",""),t.commit("updIsLogin",!1),adminUse.showToast(e.msg),router.push("/login")):adminUse.showToast(e.msg+"("+e.resultCode+")","red")})}var zo=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",logout:Vo});const Oo=new Re({storage:window.localStorage,reducer:t=>({myPlatformId:t.myPlatformId})}),Eo=()=>({config:{}});var Ho=Ke({state:Eo,mutations:{updBeep(t,o){t.beep=o}},actions:zo,plugins:[Oo.plugin],modules:{}});Q.add(De);Q.add(je);Q.add(Ve);Q.add(ze);Q.add(Oe);const ve=Ee(it);ve.component("font-awesome-icon",He);ve.use(Ho).use(jo).use(Ye).mount("#app");
