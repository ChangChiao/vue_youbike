var ye=Object.defineProperty,_e=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var ae=(t,o,e)=>o in t?ye(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,T=(t,o)=>{for(var e in o||(o={}))me.call(o,e)&&ae(t,e,o[e]);if(oe)for(var e of oe(o))we.call(o,e)&&ae(t,e,o[e]);return t},H=(t,o)=>_e(t,he(o));import{u as ne,r as b,o as y,c as w,a as i,F as B,b as Y,d as S,w as fe,e as N,t as I,f as se,g as X,T as ve,p as re,h as ce,i as W,j as K,k as R,l as ee,m as ke,n as Se,q as be,s as Z,v as ie,L as _,x as Le,y as xe,z as G,A as F,B as $e,C as le,D as Pe,E as Ae,G as Ie,V as Ce,H as Te,I as O,J as Me,K as Ue,M as Ne,N as Re,O as Be,P as Ke,Q as De,R as ze}from"./vendor.1e3118df.js";const Oe=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}};Oe();var de="./images/logo.png";var C=(t,o)=>{for(const[e,a]of o)t[e]=a;return t};const je={setup(){const t=ne();return{menuList:[{title:"\u5C0B\u627E\u55AE\u8ECA",path:"/bike"},{title:"\u5C0B\u627E\u8ECA\u9053",path:"/route"}],goHome:()=>{t.push("/")}}}},Ee={class:"flex relative z-50 justify-between shadow-lg items-center px-3 font-medium h-20"},Ve={class:"menu flex"};function He(t,o,e,a,s,r){const n=b("router-link");return y(),w("header",Ee,[i("img",{class:"w-20 cursor-pointer",src:de,alt:"",onClick:o[0]||(o[0]=(...l)=>a.goHome&&a.goHome(...l))}),i("ul",Ve,[(y(!0),w(B,null,Y(a.menuList,l=>(y(),w("li",{class:"mx-3 text-lg text-primary-500",key:l.path},[S(n,{to:l.path,class:"duration-200"},{default:fe(()=>[N(I(l.title),1)]),_:2},1032,["to"])]))),128))])])}var Ye=C(je,[["render",He],["__scopeId","data-v-61dd7a3d"]]);const Ze={props:{showLoading:{type:Boolean,default:null}},setup(){}},Ge=t=>(re("data-v-efe9d588"),t=t(),ce(),t),Fe={key:0,class:"loading-wrap"},qe=Ge(()=>i("svg",{class:"spinner",width:"65px",height:"65px",viewBox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg"},[i("circle",{class:"path",fill:"none","stroke-width":"6","stroke-linecap":"round",cx:"33",cy:"33",r:"30"})],-1)),Je=[qe];function Qe(t,o,e,a,s,r){return y(),se(ve,{to:"#teleport-target"},[N(I(e.showLoading)+" ",1),e.showLoading?(y(),w("div",Fe,Je)):X("v-if",!0)])}var Xe=C(Ze,[["render",Qe],["__scopeId","data-v-efe9d588"]]);const We={components:{Loading:Xe,Header:Ye},setup(){const t=W(!1);return K("setShowLoading",e=>{t.value=e}),{showLoading:t}}};function et(t,o,e,a,s,r){const n=b("Header"),l=b("router-view"),$=b("loading");return y(),w(B,null,[S(n),S(l),S($,{showLoading:a.showLoading},null,8,["showLoading"])],64)}var tt=C(We,[["render",et]]);const D="https://ptx.transportdata.tw/MOTC/v2",ot=D+"/Bike/Station",at=D+"/Bike/Availability",nt=D+"/Cycling/Shape",st=D+"/Bike/Station/NearBy",rt=D+"/Bike/Availability/NearBy",ct=D+"/Tourism/ScenicSpot",it=D+"/Tourism/Restaurant",q=[{label:"\u81FA\u5317\u5E02",value:"Taipei"},{label:"\u65B0\u5317\u5E02",value:"NewTaipei"},{label:"\u6843\u5712\u5E02",value:"Taoyuan"},{label:"\u81FA\u4E2D\u5E02",value:"Taichung"},{label:"\u81FA\u5357\u5E02",value:"Tainan"},{label:"\u9AD8\u96C4\u5E02",value:"Kaohsiung"},{label:"\u82D7\u6817\u7E23",value:"MiaoliCounty"},{label:"\u5609\u7FA9\u5E02",value:"Chiayi"},{label:"\u5C4F\u6771\u7E23",value:"PingtungCounty"},{label:"\u91D1\u9580\u7E23",value:"KinmenCounty"}],lt={props:{city:{type:String,default:""},keyword:{type:String,default:""}},emits:["updateCity","updateKeyword","search"],setup(t,{emit:o}){return{CITY_LIST:q,updateKeyword:r=>{o("updateKeyword",r.target.value)},updateCity:r=>{o("updateCity",r.target.value)},search:()=>{o("search")}}}},dt={class:"input-box py-2"},pt=["value"],ut={class:"flex pt-3"},gt=["value"],yt=i("option",{value:""},"\u7E23\u5E02",-1),_t=["value"];function ht(t,o,e,a,s,r){const n=b("font-awesome-icon");return y(),w(B,null,[i("div",dt,[S(n,{class:"text-gray-500",icon:"search"}),i("input",{class:"w-1/2 pl-4",placeholder:"\u8F38\u5165\u95DC\u9375\u5B57",value:e.keyword,onInput:o[0]||(o[0]=(...l)=>a.updateKeyword&&a.updateKeyword(...l)),type:"text"},null,40,pt)]),i("div",ut,[i("select",{class:"w-1/2",value:e.city,onChange:o[1]||(o[1]=(...l)=>a.updateCity&&a.updateCity(...l))},[yt,(y(!0),w(B,null,Y(a.CITY_LIST,l=>(y(),w("option",{key:l.value,value:l.value},I(l.label),9,_t))),128))],40,gt),i("button",{onClick:o[2]||(o[2]=(...l)=>a.search&&a.search(...l)),class:"ml-2 w-1/2"},"\u641C\u5C0B")])],64)}var te=C(lt,[["render",ht]]),mt="./images/illustration.png";const wt={components:{Search:te},setup(){const t=ne(),o=R({city:q[0].value,keyword:""}),e=r=>{o.city=r},a=r=>{o.keyword=r},s=()=>{t.push({path:"/bike",query:{keyword:o.keyword,city:o.city}})};return H(T({},ee(o)),{search:s,updateCity:e,updateKeyword:a})}},J=t=>(re("data-v-c221866a"),t=t(),ce(),t),ft={class:"cover relative bg-primary-100"},vt={class:"search w-4/5 m-auto md:ml-40 pt-12 md:w-96 relative z-10"},kt=J(()=>i("img",{class:"w-60",src:de,alt:""},null,-1)),St=J(()=>i("p",{class:"text-2xl text-primary-500 font-extrabold"},"\u5C0B\u627E\u55AE\u8ECA,",-1)),bt=J(()=>i("p",{class:"text-2xl text-primary-500 font-extrabold pb-4"}," \u4F86\u5834\u60A0\u9592\u7684\u653E\u9B06\u4E4B\u65C5\uFF01 ",-1)),Lt=J(()=>i("img",{class:"fixed bottom-60 md:bottom-6",src:mt},null,-1));function xt(t,o,e,a,s,r){const n=b("Search");return y(),w("div",ft,[i("div",vt,[kt,St,bt,S(n,{onUpdateCity:a.updateCity,onUpdateKeyword:a.updateKeyword,onSearch:a.search,city:t.city,keyword:t.keyword},null,8,["onUpdateCity","onUpdateKeyword","onSearch","city","keyword"])]),Lt])}var $t=C(wt,[["render",xt],["__scopeId","data-v-c221866a"]]);const Pt=(t,o="success")=>{t&&console.log(t,o)},pe=t=>{let o=new Date(t);return ke(o).format("YYYY-MM-DD HH:mm:ss")},Q=(t,o)=>{let e="",a="";switch(t){case 0:e="no-available",a="\u505C\u6B62\u71DF\u904B";break;case 1:e="available",a="\u6B63\u5E38\u71DF\u904B";break;case 2:e="no-rent",a="\u66AB\u505C\u71DF\u904B";break}return o==="color"?e:a},U=Se.create({});U.interceptors.request.use(t=>{let o=t.params;return Object.keys(o).map(e=>{o[e]||delete o[e]}),t},t=>t);U.interceptors.response.use(t=>t.data,t=>{const{status:o}=t.response;return Pt(`error--${o}`,"error"),Promise.reject(t)});const z=()=>{let t="b65665fcca144956a79d25bb3edc7b34",o="daVxLDO01nPgTTwhQKVBmY-pjeQ";const e=new Date().toGMTString(),a=new be("SHA-1","TEXT");a.setHMACKey(o,"TEXT"),a.update("x-date: "+e);let s=a.getHMAC("B64");return{Authorization:`hmac username="${t}", algorithm="hmac-sha1", headers="x-date", signature="${s}"`,"X-Date":e,"Content-Type":"application/x-www-form-urlencoded"}},j=t=>{const{city:o}=t;return delete t.city,{cityPath:o,data:t}},At=t=>{const{cityPath:o,data:e}=j(t);let a={headers:z(),params:T({},e)};return U.get(ot+`/${o}`,a)},It=t=>{const{cityPath:o,data:e}=j(t);let a={headers:z(),params:T({},e)};return U.get(at+`/${o}`,a)},Ct=t=>{const{cityPath:o,data:e}=j(t);let a={headers:z(),params:T({},e)};return U.get(nt+`/${o}`,a)},Tt=t=>{let o={headers:z(),params:T({},t)};return U.get(st,o)},Mt=t=>{let o={headers:z(),params:T({},t)};return U.get(rt,o)},Ut=t=>{const{cityPath:o,data:e}=j(t);let a={headers:z(),params:T({},e)};return U.get(it+`/${o}`,a)},Nt=t=>{const{cityPath:o,data:e}=j(t);let a={headers:z(),params:T({},e)};return U.get(ct+`/${o}`,a)};const Rt={props:{city:{type:String,default:""}},emits:["getRoute"],setup(t,{emit:o}){let e=null,a=null,s=null,r=null,n=null;const l=()=>{let u="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";e=_.map("map_route"),_.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:u}).addTo(e),n=new _.MarkerClusterGroup().addTo(e),m()},$=()=>{n.clearLayers(),e.eachLayer(u=>{u instanceof _.Marker&&e.removeLayer(u)})},p=u=>{let g=u.replace("MULTILINESTRING ((","").replace("))","").split(",");console.log("newStr");const c=g[0]&&g[0].split(" "),d=g[g.length-1]&&g[g.length-1].split(" ");n.addLayer(_.marker([c[1],c[0]],{icon:a})),n.addLayer(_.marker([d[1],d[0]],{icon:a})),e.addLayer(n),f(c[1],c[0]),h(c[1],c[0])},A=(u,v)=>{u.map(g=>g.Position).forEach(g=>{const{PositionLon:c,PositionLat:d}=g;let k=v==="food"?s:r;n.addLayer(_.marker([d,c],{icon:k}))}),e.addLayer(n)},f=async(u,v)=>{const L={city:t.city,$spatialFilter:`nearby(${u},${v},${500})`};try{const g=await Nt(L);A(g,"spot")}catch(g){console.log("error",g)}},h=async(u,v)=>{try{const L={city:t.city,$spatialFilter:`nearby(${u},${v},${500})`},g=await Ut(L);A(g,"food")}catch(L){console.log("error",L)}},m=()=>{o("getRoute")},P=()=>{a=new _.Icon({iconUrl:"/images/mark/no_rent.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),s=new _.Icon({iconUrl:"/images/mark/food.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),r=new _.Icon({iconUrl:"/images/mark/spot.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]})},M=u=>{console.log("Geometry",u),$();const v=new Le.exports.Wkt;v.read(u);const L=v.toJson(),g={color:"#C50047",weight:5};n=_.geoJSON(L,{style:g}).addTo(e),n.addData(L),e.fitBounds(n.getBounds()),e.addLayer(n),p(u)};return Z(()=>{P(),l()}),ie(()=>{e=null,n=null}),{drawLine:M}}},Bt={id:"map_route",class:"map w-screen relative z-10"};function Kt(t,o,e,a,s,r){return y(),w("div",Bt)}var Dt=C(Rt,[["render",Kt],["__scopeId","data-v-3aad47fd"]]);const zt={components:{VPagination:xe},setup(){const t=G("page"),o=G("totalPage"),e=G("setPage");return{page:t,totalPage:o,updateHandler:s=>{e(s)}}}};function Ot(t,o,e,a,s,r){const n=b("v-pagination");return y(),se(n,{"v-model":a.page,pages:a.totalPage,"range-size":1,"active-color":"#DCEDFF","onUpdate:modelValue":a.updateHandler},null,8,["v-model","pages","onUpdate:modelValue"])}var ue=C(zt,[["render",Ot]]);const jt={components:{Pagination:ue,Search:te},props:{singlePageList:{type:Array,default:()=>[]},keyword:{type:String,default:""},city:{type:String,default:""}},emits:["setView","updateKeyword","updateCity","search"],setup(t,{emit:o}){return{drawLine:n=>{o("drawLine",n)},updateCity:n=>{o("updateCity",n)},updateKeyword:n=>{o("updateKeyword",n)},search:()=>{o("search")}}}},Et={class:"h-full w-96 fixed px-8 left-0 top-0 z-20 box-border pt-24 overflow-hidden bg-white"},Vt={class:"rounded-xl shadow-lg overflow-hidden"},Ht=i("div",{class:"h-8 bg-primary-500"},null,-1),Yt={class:"p-4"},Zt=i("h1",{class:"text-3xl font-bold mb-6"},"\u5C0B\u627E\u8ECA\u9053",-1),Gt={class:"h-2/3 overflow-y-scroll mt-8 mb-4"},Ft={class:""},qt=["onClick"],Jt={class:"text-xl font-bold pb-2"},Qt={class:"mr-8"},Xt=i("span",{class:"sub-title"},"\u958B\u59CB",-1),Wt=i("span",{class:"sub-title"},"\u7D50\u675F",-1);function eo(t,o,e,a,s,r){const n=b("Search"),l=b("font-awesome-icon"),$=b("pagination");return y(),w("div",Et,[i("div",Vt,[Ht,i("div",Yt,[Zt,S(n,{onSearch:a.search,onUpdateCity:a.updateCity,onUpdateKeyword:a.updateKeyword,city:e.city,keyword:e.keyword},null,8,["onSearch","onUpdateCity","onUpdateKeyword","city","keyword"])])]),i("div",Gt,[i("ul",Ft,[(y(!0),w(B,null,Y(e.singlePageList,p=>(y(),w("li",{class:"bg-grey-100 rounded-xl mb-3 px-2 py-4 cursor-pointer",key:p.StationUID,onClick:A=>a.drawLine(p.Geometry)},[i("h3",Jt,I(p.RouteName),1),i("h4",null,[S(l,{class:"text-primary-500",icon:"map-marker-alt"}),N(" "+I(`${p.City}`),1)]),i("p",null,[i("span",Qt,[S(l,{class:"text-primary-500 mr-2",icon:"exchange-alt"}),N(I(p.Direction||"\u55AE\u5411"),1)]),i("span",null,[S(l,{class:"text-primary-500 mr-2",icon:"route"}),N(I(p.CyclingLength)+"\u516C\u5C3A",1)])]),i("p",null,[Xt,N(I(p.RoadSectionStart),1)]),i("p",null,[Wt,N(I(p.RoadSectionEnd),1)]),X(" <button >\u67E5\u770B\u4F4D\u7F6E</button> ")],8,qt))),128))])]),S($)])}var to=C(jt,[["render",eo]]);const oo={components:{MapRoute:Dt,RouteList:to},setup(){const t=W(null),o=R({keyword:"",city:q[0].value,page:1,totalPage:1}),e=f=>{o.city=f},a=f=>{o.keyword=f},s=R([]),r=async()=>{const f={city:o.city};try{const h=await Ct(f);console.log("result",h),h.length>0&&(console.log("innnnn"),Object.assign(s,h),o.totalPage=Math.ceil(s.length/30),o.page=1,A())}catch(h){console.log("error",h)}},n=f=>{o.page=f,A()},l=()=>{r()},$=f=>{t.value.drawLine(f)};K("totalPage",F(o,"totalPage")),K("page",F(o,"page")),K("setPage",n);const p=R([]),A=()=>{const f=[...s],h=(o.page-1)*30,m=f.splice(h,30);Object.assign(p,m);const P=p[0];$(P.Geometry)};return Z(()=>{}),H(T({},ee(o)),{updateCity:e,updateKeyword:a,singlePageList:p,getRoute:r,mapInstance:t,drawLine:$,search:l})}};function ao(t,o,e,a,s,r){const n=b("map-route"),l=b("route-list");return y(),w(B,null,[S(n,{ref:"mapInstance",city:t.city,singlePageList:a.singlePageList,onGetRoute:a.getRoute},null,8,["city","singlePageList","onGetRoute"]),S(l,{onSearch:a.search,onDrawLine:a.drawLine,onUpdateCity:a.updateCity,onUpdateKeyword:a.updateKeyword,singlePageList:a.singlePageList,keyword:t.keyword,city:t.city},null,8,["onSearch","onDrawLine","onUpdateCity","onUpdateKeyword","singlePageList","keyword","city"])],64)}var no=C(oo,[["render",ao]]);const so={props:{singlePageList:{type:Array,default:()=>[]}},emits:["mapReady"],setup(t,{emit:o}){let e=null,a=null,s=null,r=null,n=null;const l=()=>{let m="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";e=_.map("map"),_.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:m}).addTo(e),a=new _.MarkerClusterGroup().addTo(e),o("mapReady")},$=()=>{a.clearLayers(),e.eachLayer(m=>{m instanceof _.Marker&&e.removeLayer(m)})},p=(m,P)=>{e.setView([m,P],18),_.marker([m,P],{icon:s}).addTo(e).bindPopup("\u4F60\u5728\u9019\uFF5E").openPopup()},A=m=>{let{PositionLat:P,PositionLon:M}=m.StationPosition,{AvailableRentBikes:u,AvailableReturnBikes:v,UpdateTime:L,StationName:g,StationAddress:c,ServiceStatus:d}=m;$(),e.setView([P,M],20),_.popup().setLatLng([P,M]).setContent(`
                <h3 class="text-xl font-bold">
                    ${g.Zh_tw}
                </h3>
                <h4 class="pt-2 text-sm">
                    <span v-html='<font-awesome-icon icon="map-marker-alt" />'></span>
                    <font-awesome-icon icon="map-marker-alt" />
                    ${c.Zh_tw}
                </h4>
                <p class="text-sm">${pe(L)}</p>
                <p class="py-2">
                    <span class="${Q(d,"color")}">
                        ${Q(d,"type")}
                    </span>
                    <span
                        class="
                            ${u>0?"available":"no-available"}
                        "
                        >
                            ${u>0?"\u5C1A\u6709\u55AE\u8ECA":"\u5DF2\u7121\u55AE\u8ECA"}
                        </span>
                </p>
                <div class="rent-info flex items-center justify-between">
                    <div class="w-1/2 h-24 flex flex-col justify-center rounded-md border-primary-500 mr-4 text-center border">
                        <p class="font-bold my-1 text-primary-500 text-base">\u53EF\u501F\u55AE\u8ECA</p>
                        <p class="font-bold text-2xl">
                            ${u}
                        </p>
                    </div>
                    <div class="w-1/2 h-24 flex flex-col justify-center rounded-md border-primary-500 text-center border">
                        <p class="font-bold text-primary-500 text-base">\u53EF\u505C\u7A7A\u4F4D</p>
                        <p class="font-bold text-2xl">
                            ${v}
                        </p>
                    </div>
                </div> `).openOn(e)},f=()=>{r=new _.Icon({iconUrl:"./images/mark/no_rent.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),n=new _.Icon({iconUrl:"./images/mark/bike.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),s=new _.Icon({iconUrl:"./images/mark/currentLocation.png",shadowUrl:"",iconSize:[40,41],iconAnchor:[12,41],popupAnchor:[1,-34]})},h=()=>{$(),console.log("drawMark",t.singlePageList),t.singlePageList.forEach(m=>{let{PositionLat:P,PositionLon:M}=m.StationPosition;console.log("878787",P,M);let{AvailableRentBikes:u}=m;const v=u>0?n:r;a.addLayer(_.marker([P,M],{icon:v}))}),e.addLayer(a)};return Z(()=>{f(),l()}),ie(()=>{console.log("onBeforeUnmount--bikemap"),e=null,a=null}),{drawSelfMark:p,drawMark:h,setView:A,transType:Q,transTime:pe}}},ro={id:"map",class:"map w-screen relative z-10"};function co(t,o,e,a,s,r){return y(),w("div",ro)}var io=C(so,[["render",co]]);const lo={components:{Pagination:ue,Search:te},props:{singlePageList:{type:Array,default:()=>[]},keyword:{type:String,default:""},city:{type:String,default:""}},emits:["setView","updateKeyword","updateCity","search"],setup(t,{emit:o}){const e=n=>{o("setView",n)},a=n=>{o("updateKeyword",n)},s=n=>{o("updateCity",n)},r=()=>{o("search")};return $e("singlePageList",()=>{console.warn("change~~",singlePageList)}),{setView:e,updateCity:s,updateKeyword:a,search:r,transType:Q}}},po={class:"h-full w-96 fixed px-8 left-0 top-0 z-20 box-border pt-24 overflow-hidden bg-white"},uo={class:"rounded-xl shadow-lg overflow-hidden"},go=i("div",{class:"h-8 bg-primary-500"},null,-1),yo={class:"p-4"},_o=i("h1",{class:"text-3xl font-bold mb-6"},"\u5C0B\u627E\u55AE\u8ECA",-1),ho={class:"h-2/3 overflow-y-scroll mt-8 mb-4"},mo={class:""},wo=["onClick"],fo={class:"text-xl font-bold"},vo={class:"py-2"};function ko(t,o,e,a,s,r){const n=b("Search"),l=b("font-awesome-icon"),$=b("pagination");return y(),w("div",po,[i("div",uo,[go,i("div",yo,[_o,S(n,{onSearch:a.search,onUpdateCity:a.updateCity,onUpdateKeyword:a.updateKeyword,city:e.city,keyword:e.keyword},null,8,["onSearch","onUpdateCity","onUpdateKeyword","city","keyword"])])]),i("div",ho,[i("ul",mo,[(y(!0),w(B,null,Y(e.singlePageList,p=>(y(),w("li",{class:"bg-grey-100 rounded-xl mb-3 px-2 py-4 cursor-pointer",key:p.StationUID,onClick:A=>a.setView(p)},[i("h3",fo,I(p.StationName.Zh_tw),1),i("h4",null,[S(l,{icon:"map-marker-alt"}),N(" "+I(p.StationAddress.Zh_tw),1)]),i("p",vo,[i("span",{class:le(a.transType(p.ServiceStatus,"color"))},I(a.transType(p.ServiceStatus,"type")),3),i("span",{class:le(p.AvailableRentBikes>0?"available":"no-available")},I(p.AvailableRentBikes>0?"\u5C1A\u6709\u55AE\u8ECA":"\u5DF2\u7121\u55AE\u8ECA"),3)]),X(" <button >\u67E5\u770B\u4F4D\u7F6E</button> ")],8,wo))),128))])]),S($)])}var So=C(lo,[["render",ko]]);const bo={components:{MapBike:io,BikeList:So},setup(){const t=W(null),o=Pe(),e=R({keyword:"",city:q[0].value,page:1,totalPage:1}),a=c=>{e.city=c},s=c=>{e.keyword=c},r=()=>{const c=o.query.city;c&&(e.city=c);const d=o.query.keyword;d&&(e.keyword=d),c||d?A():(console.log("getNowPos!!!"),M())},n=G("setShowLoading");console.log("setShowLoading--inject",n);const l=c=>{n(c)},$=()=>{A()},p=R([]),A=async()=>{console.log("getBikeStation");const c={city:e.city,$filter:e.keyword?`contains(StationAddress.Zh_tw,'${e.keyword}') or contains(StationName.Zh_tw,'${e.keyword}')`:""};try{const d=await At(c);console.log("station",d),Object.assign(p,d),m()}catch(d){console.log("error",d)}},f=async({longitude:c,latitude:d})=>{console.log("getNearByInfo",c,d);const k={city:e.city,$filter:e.keyword?`contains(StationAddress.Zh_tw,'${e.keyword}') or contains(StationName.Zh_tw,'${e.keyword}')`:"",$spatialFilter:`nearby(${d},${c},${500})`};try{const x=await Tt(k);console.log("station",x),Object.assign(p,x),P(c,d)}catch(x){console.log("error",x)}},h=R([]),m=async()=>{l(!0);const c={city:e.city,$filter:e.keyword?`contains(StationAddress.Zh_tw,'${e.keyword}') or contains(StationName.Zh_tw,'${e.keyword}')`:""};try{const d=await It(c);d.forEach(k=>{p.forEach(x=>{x.StationUID===k.StationUID&&(k.StationName=x.StationName,k.StationPosition=x.StationPosition,k.StationAddress=x.StationAddress)})}),Object.assign(h,d),console.log("availableList",h),e.totalPage=Math.ceil(h.length/30),e.page=1,L()}catch(d){console.log("error",d)}l(!1)},P=async(c,d)=>{l(!0);const k={$spatialFilter:`nearby(${d},${c},${500})`};try{const x=await Mt(k);x.forEach(E=>{p.forEach(V=>{V.StationUID===E.StationUID&&(E.StationName=V.StationName,E.StationPosition=V.StationPosition,E.StationAddress=V.StationAddress)})}),Object.assign(h,x),console.log("availableList",h),e.totalPage=Math.ceil(h.length/30),e.page=1,L()}catch(x){console.log("error",x)}l(!1)},M=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(c=>{const d=c.coords.longitude,k=c.coords.latitude;console.log("longitude",d),console.log("latitude",k),t.value.drawSelfMark(k,d),f({longitude:d,latitude:k})},c=>{const{code:d,message:k}=c;console.log("error",`code=${d}, msg=${k}`),A()})},u=c=>{e.page=c,L()};K("totalPage",F(e,"totalPage")),K("page",F(e,"page")),K("setPage",u);const v=R([]),L=()=>{const c=[...h],d=(e.page-1)*30,k=c.splice(d,30);Object.assign(v,k),console.log("singlePageList",v),t.value.drawMark();const x=v[0];g(x)},g=c=>{t.value.setView(c)};return Z(()=>{}),H(T({},ee(e)),{getNearByInfo:f,availableList:h,mapReady:r,mapInstance:t,updateCity:a,singlePageList:v,updateKeyword:s,setView:g,search:$})}};function Lo(t,o,e,a,s,r){const n=b("map-bike"),l=b("bike-list");return y(),w("div",null,[S(n,{ref:"mapInstance",singlePageList:a.singlePageList,onMapReady:a.mapReady},null,8,["singlePageList","onMapReady"]),S(l,{onSearch:a.search,onSetView:a.setView,onUpdateCity:a.updateCity,onUpdateKeyword:a.updateKeyword,singlePageList:a.singlePageList,city:t.city,keyword:t.keyword},null,8,["onSearch","onSetView","onUpdateCity","onUpdateKeyword","singlePageList","city","keyword"])])}var xo=C(bo,[["render",Lo]]);const $o=[{path:"/",name:"Index",component:$t},{path:"/route",name:"Route",component:no},{path:"/bike",name:"Bike",component:xo}],Po=Ae({history:Ie(),routes:$o});function Ao(t){const e={tId:adminUse.Cookie("cAa")};t.commit("updLoading",!0),adminUse.getAjax(t.state.config.groupPath.platformAdmin+"/backLogOut",e).then(a=>{t.commit("updLoading",!1),a.resultCode=="000"?(adminUse.Cookie("remove","cAa"),t.commit("updMenuList",""),t.commit("updUserName",""),t.commit("updIsLogin",!1),adminUse.showToast(a.msg),router.push("/login")):adminUse.showToast(a.msg+"("+a.resultCode+")","red")})}var Io=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",logout:Ao});const Co=new Ce({storage:window.localStorage,reducer:t=>({myPlatformId:t.myPlatformId})}),To=()=>({config:{}});var Mo=Te({state:To,mutations:{updBeep(t,o){t.beep=o}},actions:Io,plugins:[Co.plugin],modules:{}});O.add(Me);O.add(Ue);O.add(Ne);O.add(Re);O.add(Be);const ge=Ke(tt);ge.component("font-awesome-icon",De);ge.use(Mo).use(Po).use(ze).mount("#app");
