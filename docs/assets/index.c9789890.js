var Y=Object.defineProperty;var P=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var N=(e,t,o)=>t in e?Y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,x=(e,t)=>{for(var o in t||(t={}))V.call(t,o)&&N(e,o,t[o]);if(P)for(var o of P(t))Z.call(t,o)&&N(e,o,t[o]);return e};import{r as v,o as h,c as g,a as b,w as B,b as k,F as L,d as C,p as G,e as R,f as F,t as E,g as A,h as Q,i as q,j as W,k as O,l as z,L as m,m as X,n as J,q as K,V as ee,s as te,u as oe,B as ae}from"./vendor.5eb59ad0.js";const re=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function o(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(r){if(r.ep)return;r.ep=!0;const n=o(r);fetch(r.href,n)}};re();var ne="./images/logo.png";var f=(e,t)=>{for(const[o,a]of t)e[o]=a;return e};const se={setup(){return{menuList:[{title:"\u4ECA\u65E5\u5929\u6C23",path:"/weather"},{title:"\u81EA\u884C\u8ECA\u9053",path:"/bikemap"},{title:"\u5468\u570D\u666F\u9EDE",path:"/spot"},{title:"\u6B77\u53F2\u7D00\u9304",path:"/history"}]}}},j=e=>(G("data-v-61dd7a3d"),e=e(),R(),e),ce={class:"flex justify-center box-border border-solid border-t-8 border-sub items-center font-medium"},ie=j(()=>k("img",{class:"pr-10",src:ne,alt:""},null,-1)),pe={class:"input-box flex h-10 w-56 items-center rounded-3xl text-gray-500"},le=j(()=>k("input",{class:"w-30 pl-4 bg-transparent text-gray-900",placeholder:"\u641C\u5C0B\u81EA\u884C\u8ECA\u79DF\u501F\u7AD9",type:"text"},null,-1)),de={class:"menu flex"};function ue(e,t,o,a,r,n){const i=v("router-link"),y=v("BootstrapIcon");return h(),g("header",ce,[b(i,{to:"/"},{default:B(()=>[ie]),_:1}),k("div",pe,[b(y,{icon:"search",size:"2x","flip-v":""}),le]),k("ul",de,[(h(!0),g(L,null,C(a.menuList,c=>(h(),g("li",{class:"mx-3 text-lg",key:c.path},[b(i,{to:c.path,class:"duration-200"},{default:B(()=>[F(E(c.title),1)]),_:2},1032,["to"])]))),128))])])}var M=f(se,[["render",ue],["__scopeId","data-v-61dd7a3d"]]);const me={components:{Header:M},setup(){}};function _e(e){return(t,o)=>{const a=v("router-view");return h(),g(L,null,[b(M),b(a)],64)}}const he=Object.assign(me,{setup:_e}),ge={components:{Header:M},setup(){return{address:A({list:[]})}}},fe={class:"text-grey-300 font-bold bg-green-500"};function ye(e,t,o,a,r,n){return h(),g("div",null,[Q(" <Header /> "),k("ul",fe,[(h(!0),g(L,null,C(a.address.list,i=>(h(),g("li",{key:i.StationUID},E(i.StationAddress),1))),128))])])}var $e=f(ge,[["render",ye]]);const we={setup(){}};function be(e,t,o,a,r,n){return" weather "}var ve=f(we,[["render",be]]);const S=q.create();S.interceptors.request.use(e=>e,e=>e);S.interceptors.response.use(e=>e.data,e=>Promise.reject(e));const I="https://ptx.transportdata.tw/MOTC/v2",ke=I+"/Cycling/Shape",Se=I+"/Bike/Station/NearBy",xe=I+"/Bike/Availability/NearBy",Ae=()=>{let e="b65665fcca144956a79d25bb3edc7b34",t="daVxLDO01nPgTTwhQKVBmY-pjeQ";const o=new Date().toGMTString(),a=new W("SHA-1","TEXT");a.setHMACKey(t,"TEXT"),a.update("x-date: "+o);let r=a.getHMAC("B64");return{Authorization:`hmac username="${e}", algorithm="hmac-sha1", headers="x-date", signature="${r}"`,"X-Date":o,"Content-Type":"application/x-www-form-urlencoded"}},T=()=>({headers:Ae()}),Le=e=>{const{city:t=""}=e;return delete e.city,{cityPath:t,data:e}},Me=e=>{const{cityPath:t,data:o}=Le(e);return S.get(ke+`/${t}`,{params:x({},o)},T)},Ie=e=>S.get(Se,{params:x({},e)},T),Te=e=>S.get(xe,{params:x({},e)},T),Pe={setup(){let e=null,t=null;const o=()=>{let s="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";e=m.map("map"),m.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:s}).addTo(e),t=new m.MarkerClusterGroup().addTo(e),r()},a=()=>{t.clearLayers(),e.eachLayer(s=>{s instanceof m.Marker&&e.removeLayer(s)})},r=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(s=>{const p=s.coords.longitude,l=s.coords.latitude;console.log("longitude",p),console.log("latitude",l),e.setView([l,p],18),m.marker([l,p]).addTo(e).bindPopup("A pretty CSS3 popup.<br> Easily customizable.").openPopup(),i(p,l)},s=>{const{code:p,message:l}=s;console.log("error",`code=${p}, msg=${l}`)})},n=A([]),i=async(s,p)=>{const l={$spatialFilter:`nearby(${p},${s},${500})`};try{const _=await Ie(l);console.log("station",_),Object.assign(n,_),c(s,p)}catch(_){console.log("error",_)}},y=A([]),c=async(s,p)=>{const l={$spatialFilter:`nearby(${p},${s},${500})`};try{const _=await Te(l);_.forEach($=>{n.forEach(w=>{w.StationUID===$.StationUID&&($.StationName=w.StationName,$.StationPosition=w.StationPosition,$.StationAddress=w.StationAddress)})}),Object.assign(y,_),console.log("availableList",y),u()}catch(_){console.log("error",_)}},d=s=>new Date(s).toString("Zh_tw"),u=()=>{a(),y.forEach(s=>{let{PositionLat:p,PositionLon:l}=s.StationPosition,{AvailableRentBikes:_,AvailableReturnBikes:$,UpdateTime:w,StationName:H,StationAddress:U}=s;t.addLayer(m.marker([p,l]).bindPopup(`
                <h2 class="title">${H.Zh_tw}</h2>
                <h4>\u5730\u5740:${U.Zh_tw}</h4>
                <h4>\u53EF\u501F\u8173\u8E0F\u8ECA\u6578:${_}</h4>
                <h4>\u53EF\u9084\u8173\u8E0F\u8ECA\u6578:${$}</h4>
                <h4>\u66F4\u65B0\u6642\u9593:${d(w)}</h4>
                <a target="_blank" href='https://www.google.com/maps/search/?api=1&query=${p},${l}'>\u5728google map\u4E0A\u67E5\u770B</a>`))}),e.addLayer(t)};return O(()=>{o()}),z(()=>{e=null}),{}}},Ne={id:"map",class:"w-screen h-screen"};function Be(e,t,o,a,r,n){return h(),g("div",Ne)}var Ce=f(Pe,[["render",Be]]);const Ee={components:{Map:Ce},setup(){}};function Oe(e,t,o,a,r,n){const i=v("Map");return h(),g("div",null,[b(i)])}var ze=f(Ee,[["render",Oe]]);const je={setup(){}};function De(e,t,o,a,r,n){return null}var He=f(je,[["render",De]]);const Ue={setup(){let e=null,t=null;const o=A([]),a=()=>{let c="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";e=m.map("map"),m.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/bike",tileSize:512,zoomOffset:-1,accessToken:c}).addTo(e),t=new m.MarkerClusterGroup().addTo(e),n()},r=()=>{t.clearLayers(),e.eachLayer(c=>{c instanceof m.Marker&&e.removeLayer(c)})},n=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(c=>{const d=c.coords.longitude,u=c.coords.latitude;console.log("longitude",d),console.log("latitude",u),e.setView([u,d],18),m.marker([u,d]).addTo(e).bindPopup("A pretty CSS3 popup.<br> Easily customizable.").openPopup(),i(d,u)},c=>{const{code:d,message:u}=c;console.log("error",`code=${d}, msg=${u}`)})},i=async(c,d)=>{const u={$spatialFilter:`nearby(${d},${c},${100})`};try{const s=await Me(u);Object.assign(o,s),y()}catch(s){console.log("error",s)}},y=()=>{r(),o.forEach(c=>{let{PositionLat:d,PositionLon:u}=c.StationPosition,{BikesCapacity:s,StationName:p,StationAddress:l}=c;t.addLayer(m.marker([d,u]).bindPopup(`
                <h2>${p.Zh_tw}</h2>
                <h4>\u5730\u5740${l.Zh_tw}</h4>
                <h4>\u53EF\u5BB9\u7D0D\u8173\u8E0F\u8ECA\u6578:${s}</h4>
                <a target="_blank" href='https://www.google.com/maps/search/?api=1&query=${d},${u}'>\u5728google map\u4E0A\u67E5\u770B</a>`))}),e.addLayer(t)};return O(()=>{a()}),z(()=>{e=null}),{}}},Ye={id:"map",class:"w-screen h-screen"};function Ve(e,t,o,a,r,n){return h(),g("div",Ye)}var Ze=f(Ue,[["render",Ve]]);const Ge={components:{MapRoute:Ze},setup(){}};function Re(e,t,o,a,r,n){const i=v("map-route");return h(),X(i)}var Fe=f(Ge,[["render",Re]]);const Qe=[{path:"/",name:"Index",component:$e},{path:"/weather",name:"Weather",component:ve},{path:"/bikemap",name:"BikeMap",component:ze},{path:"/history",name:"History",component:He},{path:"/Spot",name:"Spot",component:Fe}],qe=J({history:K(),routes:Qe});function We(e){const o={tId:adminUse.Cookie("cAa")};e.commit("updLoading",!0),adminUse.getAjax(e.state.config.groupPath.platformAdmin+"/backLogOut",o).then(a=>{e.commit("updLoading",!1),a.resultCode=="000"?(adminUse.Cookie("remove","cAa"),e.commit("updMenuList",""),e.commit("updUserName",""),e.commit("updIsLogin",!1),adminUse.showToast(a.msg),router.push("/login")):adminUse.showToast(a.msg+"("+a.resultCode+")","red")})}var Xe=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",logout:We});const Je=new ee({storage:window.localStorage,reducer:e=>({myPlatformId:e.myPlatformId})}),Ke=()=>({config:{}});var et=te({state:Ke,mutations:{updBeep(e,t){e.beep=t}},actions:Xe,plugins:[Je.plugin],modules:{}});const D=oe(he);D.component("BootstrapIcon",ae);D.use(et).use(qe).mount("#app");
