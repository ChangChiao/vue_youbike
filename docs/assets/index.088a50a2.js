var W=Object.defineProperty,X=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var z=(e,t,o)=>t in e?W(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,x=(e,t)=>{for(var o in t||(t={}))ee.call(t,o)&&z(e,o,t[o]);if(R)for(var o of R(t))te.call(t,o)&&z(e,o,t[o]);return e},O=(e,t)=>X(e,q(t));import{r as A,o as p,c as d,a as w,w as U,b as f,F as k,d as L,p as E,e as j,f as oe,t as M,g as T,h as ae,i as ne,j as re,k as H,l as Y,L as _,m as D,n as se,q as V,v as G,s as ie,u as ce,x as le,y as ue,V as pe,z as de,A as me,B as _e}from"./vendor.4ba96625.js";const he=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}};he();var ge="./images/logo.png";var y=(e,t)=>{for(const[o,a]of t)e[o]=a;return e};const fe={setup(){return{menuList:[{title:"\u4ECA\u65E5\u5929\u6C23",path:"/weather"},{title:"\u81EA\u884C\u8ECA\u9053",path:"/bikemap"},{title:"\u5468\u570D\u666F\u9EDE",path:"/spot"},{title:"\u6B77\u53F2\u7D00\u9304",path:"/history"}]}}},Z=e=>(E("data-v-61dd7a3d"),e=e(),j(),e),ye={class:"flex justify-center box-border border-solid border-t-8 border-sub items-center font-medium"},ve=Z(()=>f("img",{class:"pr-10",src:ge,alt:""},null,-1)),be={class:"input-box flex h-10 w-56 items-center rounded-3xl text-gray-500"},$e=Z(()=>f("input",{class:"w-30 pl-4 bg-transparent text-gray-900",placeholder:"\u641C\u5C0B\u81EA\u884C\u8ECA\u79DF\u501F\u7AD9",type:"text"},null,-1)),we={class:"menu flex"};function ke(e,t,o,a,r,s){const n=A("router-link"),S=A("BootstrapIcon");return p(),d("header",ye,[w(n,{to:"/"},{default:U(()=>[ve]),_:1}),f("div",be,[w(S,{icon:"search",size:"2x","flip-v":""}),$e]),f("ul",we,[(p(!0),d(k,null,L(a.menuList,v=>(p(),d("li",{class:"mx-3 text-lg",key:v.path},[w(n,{to:v.path,class:"duration-200"},{default:U(()=>[oe(M(v.title),1)]),_:2},1032,["to"])]))),128))])])}var N=y(fe,[["render",ke],["__scopeId","data-v-61dd7a3d"]]);const Se={components:{Header:N},setup(){}};function xe(e){return(t,o)=>{const a=A("router-view");return p(),d(k,null,[w(N),w(a)],64)}}const Ae=Object.assign(Se,{setup:xe}),Ie={components:{Header:N},setup(){return{address:T({list:[]})}}},Le={class:"text-grey-300 font-bold bg-green-500"};function Me(e,t,o,a,r,s){return p(),d("div",null,[ae(" <Header /> "),f("ul",Le,[(p(!0),d(k,null,L(a.address.list,n=>(p(),d("li",{key:n.StationUID},M(n.StationAddress),1))),128))])])}var Te=y(Ie,[["render",Me]]);const Ce={setup(){}};function Ne(e,t,o,a,r,s){return" weather "}var Pe=y(Ce,[["render",Ne]]);const I=ne.create();I.interceptors.request.use(e=>e,e=>e);I.interceptors.response.use(e=>e.data,e=>Promise.reject(e));const P="https://ptx.transportdata.tw/MOTC/v2",Be=P+"/Cycling/Shape",Re=P+"/Bike/Station/NearBy",ze=P+"/Bike/Availability/NearBy",K=[{label:"\u81FA\u5317\u5E02",value:"Taipei"},{label:"\u65B0\u5317\u5E02",value:"NewTaipei"},{label:"\u6843\u5712\u5E02",value:"Taoyuan"},{label:"\u81FA\u4E2D\u5E02",value:"Taichung"},{label:"\u81FA\u5357\u5E02",value:"Tainan"},{label:"\u9AD8\u96C4\u5E02",value:"Kaohsiung"},{label:"\u57FA\u9686\u5E02",value:"Keelung"},{label:"\u65B0\u7AF9\u5E02",value:"Hsinchu"},{label:"\u65B0\u7AF9\u7E23",value:"HsinchuCounty"},{label:"\u82D7\u6817\u7E23",value:"MiaoliCounty"},{label:"\u5F70\u5316\u7E23",value:"ChanghuaCounty"},{label:"\u5357\u6295\u7E23",value:"NantouCounty"},{label:"\u96F2\u6797\u7E23",value:"YunlinCounty"},{label:"\u5609\u7FA9\u7E23",value:"ChiayiCounty"},{label:"\u5609\u7FA9\u5E02",value:"Chiayi"},{label:"\u5C4F\u6771\u7E23",value:"PingtungCounty"},{label:"\u5B9C\u862D\u7E23",value:"YilanCounty"},{label:"\u82B1\u84EE\u7E23",value:"HualienCounty"},{label:"\u81FA\u6771\u7E23",value:"TaitungCounty"},{label:"\u91D1\u9580\u7E23",value:"KinmenCounty"},{label:"\u6F8E\u6E56\u7E23",value:"PenghuCounty"},{label:"\u9023\u6C5F\u7E23",value:"LienchiangCounty"}],Oe=()=>{let e="b65665fcca144956a79d25bb3edc7b34",t="daVxLDO01nPgTTwhQKVBmY-pjeQ";const o=new Date().toGMTString(),a=new re("SHA-1","TEXT");a.setHMACKey(t,"TEXT"),a.update("x-date: "+o);let r=a.getHMAC("B64");return{Authorization:`hmac username="${e}", algorithm="hmac-sha1", headers="x-date", signature="${r}"`,"X-Date":o,"Content-Type":"application/x-www-form-urlencoded"}},B=()=>({headers:Oe()}),Ue=e=>{const{city:t=""}=e;return delete e.city,{cityPath:t,data:e}},Ee=e=>{const{cityPath:t,data:o}=Ue(e);return I.get(Be+`/${t}`,{params:x({},o)},B)},je=e=>I.get(Re,{params:x({},e)},B),He=e=>I.get(ze,{params:x({},e)},B),Ye={setup(){let e=null,t=null,o=null,a=null;const r=()=>{let l="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";e=_.map("map"),_.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:l}).addTo(e),t=new _.MarkerClusterGroup().addTo(e),s()},s=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(l=>{const u=l.coords.longitude,m=l.coords.latitude;console.log("longitude",u),console.log("latitude",m),e.setView([m,u],18),_.marker([m,u],{icon:a}).addTo(e).bindPopup("\u4F60\u5728\u9019\uFF5E").openPopup(),v(u,m)},l=>{const{code:u,message:m}=l;console.log("error",`code=${u}, msg=${m}`)})},n=T([]),S=()=>{o=new _.Icon({iconUrl:"/images/mark/RecordCircle.png",shadowUrl:"",iconSize:[40,40],iconAnchor:[12,41],popupAnchor:[1,-34]}),a=new _.Icon({iconUrl:"images/mark/currentLocation.png",shadowUrl:"",iconSize:[40,41],iconAnchor:[12,41],popupAnchor:[1,-34]})},v=async(l,u)=>{const m={$spatialFilter:`nearby(${u},${l},${500})`};try{const h=await je(m);console.log("station",h),Object.assign(n,h),c(l,u)}catch(h){console.log("error",h)}},i=T([]),c=async(l,u)=>{const m={$spatialFilter:`nearby(${u},${l},${500})`};try{const h=await He(m);h.forEach(b=>{n.forEach($=>{$.StationUID===b.StationUID&&(b.StationName=$.StationName,b.StationPosition=$.StationPosition,b.StationAddress=$.StationAddress)})}),Object.assign(i,h),console.log("availableList",i),C()}catch(h){console.log("error",h)}},g=l=>new Date(l).toString("Zh_tw"),C=()=>{i.forEach(l=>{let{PositionLat:u,PositionLon:m}=l.StationPosition,{AvailableRentBikes:h,AvailableReturnBikes:b,UpdateTime:$,StationName:J,StationAddress:Q}=l;t.addLayer(_.marker([u,m],{icon:o}).bindPopup(`
                <h2 class="title">${J.Zh_tw}</h2>
                <h4>\u5730\u5740:${Q.Zh_tw}</h4>
                <h4>\u53EF\u501F\u8173\u8E0F\u8ECA\u6578:${h}</h4>
                <h4>\u53EF\u9084\u8173\u8E0F\u8ECA\u6578:${b}</h4>
                <h4>\u66F4\u65B0\u6642\u9593:${g($)}</h4>
                <a target="_blank" href='https://www.google.com/maps/search/?api=1&query=${u},${m}'>\u5728google map\u4E0A\u67E5\u770B</a>`))}),e.addLayer(t)};return H(()=>{S(),r()}),Y(()=>{e=null}),{}}},De={id:"map",class:"w-screen h-screen"};function Ve(e,t,o,a,r,s){return p(),d("div",De)}var Ge=y(Ye,[["render",Ve]]);const Ze={components:{Map:Ge},setup(){}};function Ke(e,t,o,a,r,s){const n=A("Map");return p(),d("div",null,[w(n)])}var Fe=y(Ze,[["render",Ke]]);const Je={setup(){}};function Qe(e,t,o,a,r,s){return null}var We=y(Je,[["render",Qe]]);const Xe={setup(){let e=null,t=null;const o=T({city:K[0].value,bikeRoute:"",routeList:[]}),a=()=>{let i="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";e=_.map("map_route"),_.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:i}).addTo(e),t=new _.MarkerClusterGroup().addTo(e),S()},r=()=>{t.clearLayers(),e.eachLayer(i=>{i instanceof _.Marker&&e.removeLayer(i)})},s=async()=>{const i={city:o.city};try{const c=await Ee(i);c.length>1&&(o.routeList=c,o.bikeRoute=c[0].RouteName)}catch(c){console.log("error",c)}},n=()=>{const{Geometry:i}=o.routeList.find(c=>c.RouteName===o.bikeRoute);v(i)};D(()=>o.city,()=>{s()}),D(()=>o.bikeRoute,()=>{n()});const S=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(i=>{const c=i.coords.longitude,g=i.coords.latitude;console.log("longitude",c),console.log("latitude",g),e.setView([g,c],18),_.marker([g,c]).addTo(e).bindPopup("A pretty CSS3 popup.<br> Easily customizable.").openPopup(),s()},i=>{const{code:c,message:g}=i;console.log("error",`code=${c}, msg=${g}`)})},v=i=>{console.log("Geometry",i),r();const c=new ie.exports.Wkt;c.read(i);const g=c.toJson(),C={color:"olive",weight:5};t=_.geoJSON(g,{style:C}).addTo(e),t.addData(g),e.fitBounds(t.getBounds()),e.addLayer(t)};return H(()=>{a()}),Y(()=>{e=null}),O(x({},se(o)),{CITY_LIST:K})}},qe=e=>(E("data-v-3aad47fd"),e=e(),j(),e),et=qe(()=>f("div",{id:"map_route",class:"w-screen h-screen"},null,-1)),tt={class:"fixed top-20 right-10 w-20 h-20 z-20"},ot=["value"],at=["value"];function nt(e,t,o,a,r,s){return p(),d(k,null,[et,f("div",tt,[V(f("select",{name:"",id:"","onUpdate:modelValue":t[0]||(t[0]=n=>e.city=n)},[(p(!0),d(k,null,L(a.CITY_LIST,n=>(p(),d("option",{key:n.value,value:n.value},M(n.label),9,ot))),128))],512),[[G,e.city]]),V(f("select",{name:"",id:"","onUpdate:modelValue":t[1]||(t[1]=n=>e.bikeRoute=n)},[(p(!0),d(k,null,L(e.routeList,n=>(p(),d("option",{key:n.RouteName,value:n.RouteName},M(n.RouteName),9,at))),128))],512),[[G,e.bikeRoute]])])],64)}var rt=y(Xe,[["render",nt],["__scopeId","data-v-3aad47fd"]]);const st={components:{MapRoute:rt},setup(){}};function it(e,t,o,a,r,s){const n=A("map-route");return p(),ce(n)}var ct=y(st,[["render",it]]);const lt=[{path:"/",name:"Index",component:Te},{path:"/weather",name:"Weather",component:Pe},{path:"/bikemap",name:"BikeMap",component:Fe},{path:"/history",name:"History",component:We},{path:"/Spot",name:"Spot",component:ct}],ut=le({history:ue(),routes:lt});function pt(e){const o={tId:adminUse.Cookie("cAa")};e.commit("updLoading",!0),adminUse.getAjax(e.state.config.groupPath.platformAdmin+"/backLogOut",o).then(a=>{e.commit("updLoading",!1),a.resultCode=="000"?(adminUse.Cookie("remove","cAa"),e.commit("updMenuList",""),e.commit("updUserName",""),e.commit("updIsLogin",!1),adminUse.showToast(a.msg),router.push("/login")):adminUse.showToast(a.msg+"("+a.resultCode+")","red")})}var dt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",logout:pt});const mt=new pe({storage:window.localStorage,reducer:e=>({myPlatformId:e.myPlatformId})}),_t=()=>({config:{}});var ht=de({state:_t,mutations:{updBeep(e,t){e.beep=t}},actions:dt,plugins:[mt.plugin],modules:{}});const F=me(Ae);F.component("BootstrapIcon",_e);F.use(ht).use(ut).mount("#app");
