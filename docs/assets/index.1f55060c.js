var P=Object.defineProperty;var b=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var x=(e,t,o)=>t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,k=(e,t)=>{for(var o in t||(t={}))O.call(t,o)&&x(e,o,t[o]);if(b)for(var o of b(t))j.call(t,o)&&x(e,o,t[o]);return e};import{r as g,o as d,c as u,a as m,w as S,b as h,F as y,d as M,p as H,e as z,f as L,t as I,g as A,h as E,i as U,j as V,k as D,l as Y,L as _,m as G,n as Z,V as q,q as F,s as K,B as Q}from"./vendor.e28af046.js";const W=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function o(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerpolicy&&(n.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?n.credentials="include":a.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(a){if(a.ep)return;a.ep=!0;const n=o(a);fetch(a.href,n)}};W();var X="./images/logo.png";var l=(e,t)=>{for(const[o,r]of t)e[o]=r;return e};const R={setup(){return{menuList:[{title:"\u4ECA\u65E5\u5929\u6C23",path:"/weather"},{title:"\u81EA\u884C\u8ECA\u9053",path:"/bikemap"},{title:"\u5468\u570D\u666F\u9EDE",path:"/spot"},{title:"\u6B77\u53F2\u7D00\u9304",path:"/history"}]}}},T=e=>(H("data-v-61dd7a3d"),e=e(),z(),e),J={class:"flex justify-center box-border border-solid border-t-8 border-sub items-center font-medium"},ee=T(()=>h("img",{class:"pr-10",src:X,alt:""},null,-1)),te={class:"input-box flex h-10 w-56 items-center rounded-3xl text-gray-500"},oe=T(()=>h("input",{class:"w-30 pl-4 bg-transparent text-gray-900",placeholder:"\u641C\u5C0B\u81EA\u884C\u8ECA\u79DF\u501F\u7AD9",type:"text"},null,-1)),re={class:"menu flex"};function ae(e,t,o,r,a,n){const c=g("router-link"),$=g("BootstrapIcon");return d(),u("header",J,[m(c,{to:"/"},{default:S(()=>[ee]),_:1}),h("div",te,[m($,{icon:"search",size:"2x","flip-v":""}),oe]),h("ul",re,[(d(!0),u(y,null,M(r.menuList,s=>(d(),u("li",{class:"mx-3 text-lg",key:s.path},[m(c,{to:s.path,class:"duration-200"},{default:S(()=>[L(I(s.title),1)]),_:2},1032,["to"])]))),128))])])}var v=l(R,[["render",ae],["__scopeId","data-v-61dd7a3d"]]);const ne={components:{Header:v},setup(){}};function se(e){return(t,o)=>{const r=g("router-view");return d(),u(y,null,[m(v),m(r)],64)}}const ce=Object.assign(ne,{setup:se}),ie={components:{Header:v},setup(){return{address:A({list:[]})}}},pe={class:"text-grey-300 font-bold bg-green-500"};function de(e,t,o,r,a,n){return d(),u("div",null,[E(" <Header /> "),h("ul",pe,[(d(!0),u(y,null,M(r.address.list,c=>(d(),u("li",{key:c.StationUID},I(c.StationAddress),1))),128))])])}var ue=l(ie,[["render",de]]);const le={setup(){}};function me(e,t,o,r,a,n){return" weather "}var _e=l(le,[["render",me]]);const w=U.create();w.interceptors.request.use(e=>e,e=>e);w.interceptors.response.use(e=>e.data,e=>Promise.reject(e));const he="https://ptx.transportdata.tw/MOTC/v2",fe=he+"/Bike/Station/NearBy",ge=()=>{let e="b65665fcca144956a79d25bb3edc7b34",t="daVxLDO01nPgTTwhQKVBmY-pjeQ";const o=new Date().toGMTString(),r=new V("SHA-1","TEXT");r.setHMACKey(t,"TEXT"),r.update("x-date: "+o);let a=r.getHMAC("B64");return{Authorization:`hmac username="${e}", algorithm="hmac-sha1", headers="x-date", signature="${a}"`,"X-Date":o,"Content-Type":"application/x-www-form-urlencoded"}},$e=()=>({headers:ge()}),ye=e=>w.get(fe,{params:k({},e)},$e),ve={setup(){let e=null,t=null;const o=A([]),r=()=>{let s="pk.eyJ1Ijoiam9lY2hhbmcxMDE0IiwiYSI6ImNrdno1ZnM3OTRtM2YzMG8wYnA2NGxpZzEifQ.EDTMLv4rcckA89UjJNWgXQ";e=_.map("map"),_.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:s}).addTo(e),t=new _.MarkerClusterGroup().addTo(e),n()},a=()=>{t.clearLayers(),e.eachLayer(s=>{s instanceof _.Marker&&e.removeLayer(s)})},n=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(s=>{const i=s.coords.longitude,p=s.coords.latitude;console.log("longitude",i),console.log("latitude",p),e.setView([p,i],18),_.marker([p,i]).addTo(e).bindPopup("A pretty CSS3 popup.<br> Easily customizable.").openPopup(),c(i,p)},s=>{const{code:i,message:p}=s;console.log("error",`code=${i}, msg=${p}`)})},c=async(s,i)=>{const p={$spatialFilter:`nearby(${i},${s},${100})`},f=await ye(p);Object.assign(o,f),console.log("result===",f),$()},$=()=>{a(),o.forEach(s=>{let{PositionLat:i,PositionLon:p}=s.StationPosition,{BikesCapacity:f,StationName:C,StationAddress:N}=s;t.addLayer(_.marker([i,p]).bindPopup(`
                <h2>${C.Zh_tw}</h2>
                <h4>\u5730\u5740${N.Zh_tw}</h4>
                <h4>\u53EF\u5BB9\u7D0D\u8173\u8E0F\u8ECA\u6578:${f}</h4>
                <a target="_blank" href='https://www.google.com/maps/search/?api=1&query=${i},${p}'>\u5728google map\u4E0A\u67E5\u770B</a>`))}),e.addLayer(t)};return D(()=>{r()}),Y(()=>{e=null}),{}}},we={id:"map",class:"w-screen h-screen"};function be(e,t,o,r,a,n){return d(),u("div",we)}var xe=l(ve,[["render",be]]);const ke={components:{Map:xe},setup(){}},Se=L(" map ");function Me(e,t,o,r,a,n){const c=g("Map");return d(),u("div",null,[Se,m(c)])}var Le=l(ke,[["render",Me]]);const Ie={setup(){}};function Ae(e,t,o,r,a,n){return null}var Te=l(Ie,[["render",Ae]]);const Be={setup(){}};function Ce(e,t,o,r,a,n){return" spot "}var Ne=l(Be,[["render",Ce]]);const Pe=[{path:"/",name:"Index",component:ue},{path:"/weather",name:"Weather",component:_e},{path:"/bikemap",name:"BikeMap",component:Le},{path:"/history",name:"History",component:Te},{path:"/Spot",name:"Spot",component:Ne}],Oe=G({history:Z(),routes:Pe});function je(e){const o={tId:adminUse.Cookie("cAa")};e.commit("updLoading",!0),adminUse.getAjax(e.state.config.groupPath.platformAdmin+"/backLogOut",o).then(r=>{e.commit("updLoading",!1),r.resultCode=="000"?(adminUse.Cookie("remove","cAa"),e.commit("updMenuList",""),e.commit("updUserName",""),e.commit("updIsLogin",!1),adminUse.showToast(r.msg),router.push("/login")):adminUse.showToast(r.msg+"("+r.resultCode+")","red")})}var He=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",logout:je});const ze=new q({storage:window.localStorage,reducer:e=>({myPlatformId:e.myPlatformId})}),Ee=()=>({config:{}});var Ue=F({state:Ee,mutations:{updBeep(e,t){e.beep=t}},actions:He,plugins:[ze.plugin],modules:{}});const B=K(ce);B.component("BootstrapIcon",Q);B.use(Ue).use(Oe).mount("#app");
